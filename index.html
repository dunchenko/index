<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta name="referrer" content="strict-origin-when-cross-origin">
    <meta http-equiv="Permissions-Policy" content="camera=(), microphone=(), geolocation=()">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://www.googletagmanager.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' data: https://fonts.gstatic.com; img-src 'self' data: https://www.google-analytics.com; frame-src https://www.google.com/maps/; connect-src 'self' https://script.google.com/ https://script.googleusercontent.com/ https://www.google-analytics.com https://analytics.google.com https://api.ipify.org;">
    <meta name="description" content="Professional legal advocacy and notary services in Ontario. Specializing in Provincial Offences and Administrative Tribunals. Accessible, expert representation tailored to your needs.">
    <title>Hanna Dunchenko | Paralegal Services GTA</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22 fill=%22%23ffffff%22>PS</text></svg>">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700;900&display=swap" rel="stylesheet">
    
    <!-- Google Analytics (GA4) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-ZMMKRZ3VBV"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-ZMMKRZ3VBV');
    </script>
    <style>
        /* ------------------- CORE STYLES ------------------- */
        :root {
            --bg-dark: #bfa792;
            --text-white: #ffffff;
            --glass-bg: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
            --placeholder-color: rgba(255, 255, 255, 0.6);
            --accent-gold: #6B5B4A;
            --accent-hover: #8B6F5A;
            --input-bg: rgba(255, 255, 255, 0.08);
        }

        * { 
            box-sizing: border-box; 
            margin: 0; 
            padding: 0; 
            font-family: 'Lato', sans-serif !important;
        }
        
        @keyframes pulseText {
            0% { opacity: 0.4; }
            50% { opacity: 0.8; }
            100% { opacity: 0.4; }
        }

        .pulseText {
            animation: pulseText 2s infinite ease-in-out;
            font-weight: 500;
        }
        
        @keyframes blurReveal {
            0% { opacity: 0; }
            100% { opacity: 1; }
        }

        body { 
            font-family: 'Lato', sans-serif; 
            background-color: var(--bg-dark); 
            color: var(--text-white); 
            line-height: 1.6; 
            min-height: 100vh;
            padding-bottom: 50px;
            animation: blurReveal 4s ease-out forwards;
        }

        /* Custom Scrollbar */
        html {
            scrollbar-width: thin; /* For Firefox */
            scrollbar-color: #5a3d2a transparent; /* thumb track */
        }
        body::-webkit-scrollbar {
            width: 8px;
        }
        body::-webkit-scrollbar-track {
            background: transparent;
        }
        body::-webkit-scrollbar-thumb {
            background-color: #5a3d2a;
            border-radius: 10px;
        }
        body::-webkit-scrollbar-thumb:hover {
            background-color: #6B5B4A;
        }
        ::-webkit-scrollbar-button { display: none; }

        /* ------------------- BLOCKS ------------------- */

        /* Block: background */
        .background { 
            position: fixed; 
            inset: 0; 
            z-index: -1; 
            overflow: hidden; 
            background: var(--bg-dark); 
        }

        .background__svg {
            width: 100%;
            height: 100%;
        }

        .background__stripe { 
            animation: anim-stripes 30s ease-in-out infinite; 
            will-change: transform; 
        }
        
        .background__stripe--delay-1 { animation-duration: 40s; animation-delay: -10s; }
        .background__stripe--delay-2 { animation-duration: 50s; animation-delay: -20s; }
        
        @keyframes anim-stripes {
            0%, 50%, 100% { transform: translate(0, 0) scaleX(1); }
            25% { transform: translate(2.5%, 1.5%) scaleX(1.06); }
            75% { transform: translate(-2.5%, -1.5%) scaleX(0.94); }
        }

        /* Pause background animation when a modal is open */
        body.modal-is-open .background__stripe {
            animation-play-state: paused;
        }
        
        /* Block: header */
        .header { 
            text-align: center; 
            padding: 50px 20px 10px;
        }

        .header__title { 
            font-size: 4.5rem; 
            font-weight: 900; 
            margin-bottom: 8px;
            letter-spacing: 1px;
            text-transform: uppercase;
            white-space: nowrap;
        }

        .header__subtitle { 
            font-size: 3.5rem; 
            font-weight: 900; 
            text-transform: uppercase;
            opacity: 0.95;
            margin-bottom: 5px;
            white-space: nowrap;
        }

        .header__contact {
            margin: 15px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }

        .header__contact-label {
            font-size: 1.8rem;
            font-weight: 900;
            color: var(--text-white);
        }

        .header__phone-link { 
            font-size: 2.3rem; 
            font-weight: 900; 
            color: var(--text-white);
            text-decoration: none;
            transition: opacity 0.3s ease;
        }

        .header__phone-link:hover { opacity: 0.8; }

        .header__seo-text {
            font-size: 1.3rem;
            font-weight: 700;
            opacity: 0.85;
            margin: 15px auto;
            line-height: 1.6;
            max-width: 800px;
        }

        .header__seo-line {
            display: block;
            margin-bottom: 8px;
            white-space: nowrap;
        }

        /* Block: layout-container */
        .layout-container { 
            max-width: 650px; 
            margin: 0 auto 0; 
            padding: 10px 20px 20px; 
        }
        
        /* Block: contact-form */
        .contact-form {
            width: 100%;
            overflow: hidden;
            background: transparent;
            border: none;
            padding: 0;
            box-shadow: none;
            border-radius: 20px;
        }

        /* Google Calendar Iframe Styling */
        .contact-form iframe {
            display: block;
            width: 100%;
            height: 800px;
            /*  No cropping: clip-path removed per user request */
            /* Margin and Scale will be set by JS script */
            filter: invert(1) grayscale(1);
            mix-blend-mode: screen;
            border: 0;
        }

        .contact-form__outside-title { 
            font-size: 1.8rem; 
            margin-bottom: 20px; 
            text-align: center; 
            font-weight: 900; 
            text-transform: uppercase; 
            letter-spacing: 2px;
            color: var(--text-white);
        }

        .contact-form__title { 
            display: none; /* Hide original if still referenced or kept for structure, but I removed it from HTML so this block is essentially being replaced/added to */
            font-size: 1.8rem; 
            margin-bottom: 30px; 
            text-align: center; 
            font-weight: 900; 
            text-transform: uppercase; 
            letter-spacing: 2px; 
        }

        .contact-form__group { 
            margin-bottom: 25px; 
            position: relative; 
        }

        .contact-form__label-row { 
            display: flex; 
            justify-content: space-between; 
            margin-bottom: 8px; 
        }

        .contact-form__label { 
            font-weight: 700; 
            text-transform: uppercase; 
            font-size: 0.85rem; 
            letter-spacing: 1px; 
        }

        .contact-form__input, 
        .contact-form__textarea, 
        .contact-form__select { 
            width: 100%; 
            padding: 16px; 
            background: var(--input-bg); 
            border: 1px solid var(--glass-border); 
            border-radius: 10px; 
            color: var(--text-white);
            font-size: 1rem; 
            outline: none; 
            transition: all 0.3s ease; 
            font-family: inherit; 
            -webkit-appearance: none;
            appearance: none;
            box-shadow: none; /* Remove iOS inner shadow */
        }

        .contact-form__input:focus, 
        .contact-form__textarea:focus, 
        .contact-form__input--has-content {
            background: #ffffff;
            color: var(--accent-gold);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.12);
            border-color: rgba(255, 255, 255, 0.5);
        }
        
        .contact-form__input::placeholder, 
        .contact-form__textarea::placeholder { 
            color: var(--placeholder-color); 
        }
        
        .contact-form__input:focus::placeholder, 
        .contact-form__textarea:focus::placeholder { 
            color: transparent; 
        }

        .contact-form__textarea { 
            resize: none; 
            min-height: 180px; 
        }
        
        .contact-form__char-counter {
            font-size: 0.75rem;
            opacity: 0.6;
            color: rgba(255, 255, 255, 0.6);
            transition: all 0.3s ease;
        }

        .contact-form__group:has(.contact-form__textarea:focus) .contact-form__char-counter {
            color: var(--accent-hover);
            opacity: 0.9;
        }

        .contact-form__textarea-accessories {
            position: relative;
        }

        .contact-form__file-upload {
            position: absolute;
            bottom: 21px;
            right: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 4px;
            cursor: pointer;
            z-index: 2;
        }

        .contact-form__upload-icon {
            width: 24px;
            height: 24px;
            color: rgba(255, 255, 255, 0.5);
            stroke: currentColor;
            fill: none;
            transition: all 0.3s ease;
            display: block;
            stroke-width: 1.5;
            opacity: 0.7;
        }

        .contact-form__file-upload:hover { transform: scale(1.1); }
        .contact-form__file-upload:hover .contact-form__upload-icon { stroke: var(--text-white); }
        
        .contact-form__textarea:focus ~ .contact-form__textarea-accessories .contact-form__upload-icon,
        .contact-form__group:has(.contact-form__textarea:focus) .contact-form__upload-icon {
            stroke: var(--accent-hover);
        }

        .contact-form__checkbox-wrapper {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-top: 15px;
        }

        .contact-form__checkbox {
            width: 28px; height: 28px;
            padding: 0;
            appearance: none; -webkit-appearance: none;
            background: var(--input-bg);
            border: 1px solid var(--glass-border);
            border-radius: 8px;
            cursor: pointer;
            display: grid; place-content: center;
            flex-shrink: 0;
        }

        .contact-form__checkbox:checked { 
            background: var(--accent-hover); 
            border-color: var(--accent-hover); 
        }
        
        .contact-form__checkbox:checked::before {
            content: ""; width: 6px; height: 10px; border: solid white; border-width: 0 2px 2px 0; transform: rotate(45deg); margin-top: -2px;
        }

        .contact-form__checkbox-label {
            font-size: 0.9rem;
            font-weight: 700;
            cursor: pointer;
        }
        
        .contact-form__terms-link {
            color: #ffffff;
            text-decoration: underline;
            cursor: pointer;
            transition: color 0.3s ease;
            font-weight: 700;
        }

        .contact-form__terms-link:hover { color: #D4B89A; }

        .contact-form__submit-button { 
            width: 100%; 
            padding: 20px; 
            background: #5a3d2a;
            color: #ffffff; 
            border: none; 
            border-radius: 10px; 
            font-weight: 900; 
            font-size: 1.1rem; 
            text-transform: uppercase; 
            cursor: pointer; 
            transition: all 0.3s ease; 
            margin-top: 10px;
            position: relative;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .contact-form__submit-button:hover { 
            transform: translateY(-2px); 
            background: var(--accent-gold); 
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.25); 
        }

        /* Shadow Removal for Buttons inside Modals */
        .modal .contact-form__submit-button,
        .modal .contact-form__submit-button:hover {
            box-shadow: none !important;
        }

        .contact-form__note {
            text-align: center;
            font-size: 0.85rem;
            opacity: 0.75;
            margin-top: 15px;
        }

        /* Block: section-title */
        .section-title { 
            font-size: 1.8rem; font-weight: 900; 
            text-transform: uppercase; letter-spacing: 2px; 
            text-align: center; margin-bottom: 30px; 
            margin-top: 30px;
        }
        
        /* Block: faq */
        .faq { margin-top: 10px; }

        .faq__item {
            margin-bottom: 15px;
            padding: 5px;
            text-align: left; /* Align FAQ content to the left */
        }
        
        .faq__question { 
            font-weight: 900; 
            font-size: 1.1rem; 
            text-transform: uppercase; 
            display: flex; 
            align-items: flex-start; 
            gap: 15px; 
            cursor: pointer;
            margin-bottom: 10px;
            list-style: none;
        }

        .faq__question::-webkit-details-marker { display: none; }
        
        .faq__question::before { 
            content: ""; display: inline-block; 
            width: 12px; height: 12px; min-width: 12px; 
            border-radius: 50%; border: 2px solid #ffffff; 
            margin-top: 5px; transition: background 0.3s;
        }
        
        details[open] > .faq__question::before { background-color: #ffffff; }

        .faq__answer { 
            font-size: 0.95rem; opacity: 0.9; 
            padding-left: 29px; 
            padding-bottom: 20px;
            line-height: 1.6;
        }

        /* Block: price-table */
        .price-table { width: 100%; border-collapse: collapse; margin-top: 15px; border: 1px solid rgba(255,255,255,0.3); }
        .price-table td { padding: 12px; border-bottom: 1px solid rgba(255,255,255,0.3); }
        .price-table td:last-child { text-align: right; font-weight: 700; }

        .price-note {
            font-size: 1rem; opacity: 0.9; display: block; margin-top: 10px; text-align: left;
        }


        /* Block: modal */
        .modal {
            display: none; /* Hidden by default */
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(4px);
            -webkit-backdrop-filter: blur(4px);
            z-index: 20000; /* Increased to be above top-bar */
            align-items: center;
            justify-content: center;
            padding: 10px;
            /* Ensure it covers screen */
            inset: 0;
            overflow-y: auto; /* Changed to auto to prevent unnecessary scrollbar */
        }

        #termsModal {
            z-index: 20001;
        }

        #termsModal .modal__content {
            max-width: 800px;
            background: #121212; /* Solid dark background to cover underlying modal */
            border: 1px solid rgba(255, 255, 255, 0.15);
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
        }

        #termsModal .modal__title {
            text-align: center;
            color: var(--accent-gold);
            margin-bottom: 30px;
            font-size: 2.2rem;
        }
        
        #termsModal .modal__section-title {
            color: #ffffff;
            font-size: 1.1rem;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            padding-bottom: 8px;
            margin-top: 30px;
            margin-bottom: 15px;
        }

        #termsModal .modal__text {
            color: rgba(255, 255, 255, 0.85);
            text-align: justify;
            margin-bottom: 15px;
        }

        #termsModal .modal__footer-text {
            text-align: center;
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.9rem;
            margin-top: 40px;
            border-top: 1px solid rgba(255,255,255,0.1);
            padding-top: 20px;
            font-weight: 400;
        }

        /* When active, use Flexbox to center */
        .modal--active { 
            display: flex !important; 
            align-items: center !important; /* Changed to center vertically */
            justify-content: center !important;
        }

        .modal__content {
            background: var(--bg-dark);
            border: 1px solid var(--glass-border);
            border-radius: 15px;
            padding: 40px;
            width: 100%;
            max-width: 600px;
            max-height: 90vh; /* Added max-height to prevent overflow */
            text-align: center; /* Symmetrically center content */
            box-sizing: border-box;            
            display: flex;
            flex-direction: column;
            
            position: relative;
            box-shadow: 0 30px 90px rgba(0, 0, 0, 0.7), 0 0 20px rgba(255, 255, 255, 0.05);
            animation: modalScaleIn 0.4s cubic-bezier(0.19, 1, 0.22, 1);
            
            /* Ensure it centers if flex alignment fails for some reason */
            margin: auto; /* Let flexbox handle centering perfectly */
        }

        @keyframes modalScaleIn {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }

        .modal__close {
            position: absolute;
            top: 20px;
            left: 20px;
            right: auto;
            background: none;
            border: none;
            font-size: 28px;
            color: var(--text-white);
            cursor: pointer;
            padding: 0;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: color 0.3s ease;
            z-index: 10;
        }

        .modal__close:hover { color: #D4B89A; }

        .modal__title {
            font-size: 1.4rem;
            font-weight: 900;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 1px;
            flex-shrink: 0;
        }

        .modal__body {
            font-size: 0.95rem;
            line-height: 1.7;
            color: var(--text-white);
            overflow-y: auto;
            padding-right: 15px;
        }

        .modal__section-title {
            font-size: 1.2rem;
            font-weight: 700;
            margin-top: 20px;
            margin-bottom: 10px;
            text-transform: uppercase;
        }
        
        .modal__text { margin-bottom: 12px; opacity: 0.95; }
        
        .modal__highlight { font-weight: 700; color: #D4B89A; }
        
        .modal__footer-text {
            margin-top: 30px; 
            padding-top: 20px; 
            border-top: 1px solid rgba(255, 255, 255, 0.2); 
            font-size: 1.15rem; 
            color: #ffffff; 
            font-weight: 700;
        }

        /* Block: footer */
        .footer {
            text-align: center;
            padding: 30px 20px;
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9rem;
            line-height: 1.8;
        }

        .footer__container { margin-bottom: 40px; }
        
        .footer__button {
            width: 100%;
            padding: 20px;
            background: #5a3d2a;
            color: #ffffff;
            border: none;
            border-radius: 10px; 
            font-weight: 900;
            font-size: 1.1rem;
            text-transform: uppercase;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            max-width: 320px;
            margin: 0 auto;
        }

        .footer__button:hover {
             transform: translateY(-2px); 
             background: var(--accent-gold); 
             box-shadow: 0 8px 20px rgba(0, 0, 0, 0.25); 
        }

        .footer__contact-link {
            display: block;
            color: #ffffff; 
            font-size: 1.8rem;
            font-weight: 900;
            text-decoration: none;
            margin-bottom: 5px;
            margin-top: 25px;
        }

        .footer__hours {
            font-size: 0.95rem; 
            color: #ffffff; 
            margin-bottom: 20px;
            white-space: pre-line;
            line-height: 1.6;
        }

        /* Block: map-container */
        .map-container {
            width: 100%; 
            height: 450px; 
            background-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIHZpZXdCb3g9IjAgMCA4MDAgNDAwIiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIj48cmVjdCB3aWR0aD0iODAwIiBoZWlnaHQ9IjQwMCIgZmlsbD0iI2UzZTNUzIiLz48dGV4dCB4PSI1MCUiIHk9IjUwJSIgZG9taW5hbnQtYmFzZWxpbmU9Im1pZGRsZSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMjQiIGZpbGw9IiM1NTUiPk1hcCBMb2FkaW5nLi4uPC90ZXh0Pjwvc3ZnPg=='); 
            background-size: cover; 
            border-radius: 10px; 
            overflow: hidden;
        }

        .map-container__iframe {
            border: 0;
            width: 100%;
            height: 100%;
        }

        .contact-form__booking-wrapper {
            display: flex;
            justify-content: center;
            align-items: flex-start; /* NEW: Pin button to top */
            margin-top: 25px;
            margin-bottom: 15px;
            height: 62px; /* Adjusted to prevent button clipping */
            overflow: hidden; /* Hide anything below the button */
        }

        /* Style the Google Button to match site buttons */
        .contact-form__booking-wrapper button {
            width: 100% !important;
            padding: 20px !important;
            background: var(--accent-hover) !important;
            color: #ffffff !important;
            border: none !important;
            border-radius: 10px !important;
            font-weight: 900 !important;
            font-size: 1.1rem !important;
            text-transform: uppercase !important;
            cursor: pointer !important;
            transition: all 0.3s ease !important;
            font-family: 'Lato', sans-serif !important;
            display: block !important;
            margin: 0 !important; /* NEW: Avoid displacement */
        }

        .contact-form__booking-wrapper button:hover {
            background: var(--accent-gold) !important;
        }

        /* ------------------- RESPONSIVE ------------------- */


        /* ------------------- CUSTOM CALENDAR (Liquid Glass Design) ------------------- */
        .calendar-wrapper {
            background: rgba(255, 255, 255, 0.01);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 24px; 
            padding: 30px;
            margin-top: 5px;
            /* Responsive Scaling */
            transform-origin: top center;
            transition: transform 0.3s ease;
        }
        
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px; /* Moved to top, added margin bottom */
            text-align: center;
            padding: 0 10px;
        }

        .calendar-title {
            font-size: 1.4rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: #ffffff;
            text-shadow: 0 1px 1px rgba(0,0,0,0.1);
            line-height: 1.2;
            display: flex;
            flex-direction: column;
            gap: 2px;
            align-items: center;
        }

        /* "Wait..." Animation */
        .loading-text {
            font-size: 1.2rem;
            font-weight: 700;
            color: rgba(255, 255, 255, 0.8);
            letter-spacing: 1px;
            animation: pulseText 1.5s infinite ease-in-out;
        }
        
        
        .calendar-title span { display: block; }
        .calendar-title .cal-month { font-size: 1.6rem; font-weight: 900; }
        .calendar-title .cal-year { font-size: 1.6rem; opacity: 0.9; font-weight: 900; letter-spacing: 2px; margin-top: -5px; }


        .calendar-nav-btn {
            background: rgba(255, 255, 255, 0);
            border: none;
            color: #ffffff; 
            border-radius: 50%;
            width: 50px; height: 50px;
            cursor: pointer;
            font-size: 1.8rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0.7;
        }

        .calendar-nav-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: scale(1.1);
            opacity: 1;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 12px;
            text-align: center;
        }

        .cal-day-name {
            font-weight: 800;
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 5px; /* Reduced from 15px */
        }

        .cal-cta {
            grid-column: 1 / span 7;
            font-size: 0.85rem;
            font-weight: 800;
            color: #ffffff;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 15px;
            opacity: 0.8;
            text-align: center;
        }

        .cal-day {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 14px;
            color: rgba(255, 255, 255, 0.7);
            background: rgba(255, 255, 255, 0.05); /* Reduced opacity */
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            font-size: 1rem;
            border: none !important; /* Force no border */
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            font-weight: 400; /* Normal weight */
        }

        .cal-day:hover:not(.cal-day--empty):not(.cal-day--disabled) {
            background: rgba(255, 255, 255, 0.25); /* Increased from 0.15 */
            border-color: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
            /* box-shadow removed */
        }

        .cal-day--disabled {
            opacity: 0.4; /* Increased from 0.15 for better visibility while remaining inactive */
            cursor: default;
            pointer-events: none;
        }

        .cal-day--selected {
            background-color: #ffffff !important;
            color: #a18570 !important; /* Coffee with milk color */
            transform: scale(1.05) !important; /* Made bigger */
            font-weight: 900 !important;
            border: 1px solid rgba(255, 255, 255, 0.3) !important;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            position: relative;
            z-index: 2;
        }

        @keyframes pulseActive {
            0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(224, 112, 32, 0.4); }
            70% { transform: scale(1.05); box-shadow: 0 0 0 10px rgba(224, 112, 32, 0); }
            100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(224, 112, 32, 0); }
        }

        .cal-day--saturday-available {
            opacity: 0.8;
            background: rgba(255, 255, 255, 0.05);
        }

        /* Gold style for Office Closed (Saturday) in Light Theme */
        .cal-day--saturday-available {
            border: none !important;
        }

        /* .cal-day--nearest-free removed */
        
        .cal-day--today {
            border: 2.5px solid #ffffff !important; 
            opacity: 1 !important;
        }

        /* Removed .cal-day--has-slots::after (dots) */
        .cal-day--has-slots {
            background: rgba(255, 255, 255, 0.2);
            opacity: 1 !important;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        /* Slots Section */
        .slots-container {
            margin-top: 0;
            margin-bottom: 5px;
            padding-top: 0;
            display: block;
            position: relative;
        }

        /* Loading Progress Bar Separator */
        .loading-separator {
            position: absolute;
            top: 0;
            left: 10%; /* Centered at 80% width */
            width: 80%; /* 20% smaller */
            height: 1px;
            background: rgba(255, 255, 255, 0.1); 
            overflow: hidden;
            
            opacity: 0; /* Hidden by default */
            transition: opacity 0.5s ease;
            
            -webkit-mask-image: linear-gradient(to right, transparent, black 15%, black 85%, transparent);
            mask-image: linear-gradient(to right, transparent, black 15%, black 85%, transparent);
        }

        .loading-separator--active {
            opacity: 1;
        }

        /* Animated bar */
        .loading-separator::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 50%;
            height: 100%;
            /* Bright white with glow */
            background: linear-gradient(90deg, transparent, #ffffff, transparent);
            box-shadow: 0 0 15px rgba(255, 255, 255, 1);
            
            opacity: 0; /* Hidden by default */
            transition: opacity 0.8s ease-out; /* Smooth fade out */
            
            animation: loadingScan 1.5s infinite linear;
        }

        .loading-separator--active::after {
            opacity: 1; /* Fade in */
        }

        @keyframes loadingScan {
            0% { transform: translateX(-100%); }
            15% { transform: translateX(200%); } /* Quick scan */
            100% { transform: translateX(200%); } /* Wait */
        }

        .loading-separator::after {
            /* ... existing styles ... */
            animation: loadingScan 10s infinite linear; /* Run every 10s */
        }

        .slots-title {
            font-size: 1.4rem; /* Increased from 1.1rem */
            font-weight: 700; /* Increased from 600 */
            margin-bottom: 25px;
            text-align: center;
            color: rgba(255, 255, 255, 0.9);
            letter-spacing: 0.5px;
            display: none; /* Hidden by default */
            animation: fadeTitle 0.5s ease forwards;
        }

        @keyframes fadeTitle { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .slots-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr); /* 2 columns for wider buttons */
            gap: 12px;
        }

        .slot-btn {
            padding: 18px 15px;
            background: rgba(255, 255, 255, 0.15);
            border: 2px solid rgba(255, 255, 255, 0.4);
            color: #fff;
            border-radius: 14px;
            cursor: pointer;
            transition: all 0.5s ease;
            font-family: 'Lato', sans-serif !important;
            font-weight: 700;
            font-size: 0.9rem;
            text-align: center;
            backdrop-filter: blur(10px);
            display: flex;
            flex-direction: column; /* Column layout for PRESS on top */
            align-items: stretch;
            justify-content: space-between;
            gap: 10px;
            line-height: 1.2;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1), 0 0 12px rgba(255, 255, 255, 0.3);
        }

        .slot-btn:hover {
            background: rgba(255, 255, 255, 0.25);
            color: #fff; 
            transform: translateY(-2px);
            box-shadow: 0 12px 35px rgba(0, 0, 0, 0.15), 0 0 20px rgba(255, 255, 255, 0.5);
        }

        .slot-btn--busy {
            opacity: 0.45;
            pointer-events: none;
            background-image: none;
            border: none !important;
            box-shadow: none !important;
            color: rgba(255, 255, 255, 0.2); 
            text-decoration: none;
            position: relative;
            overflow: hidden;
            animation: none; 
        }
        
        @keyframes slantStripes {
            0% { background-position: 0 0; }
            100% { background-position: -40px 0; }
        }

        @keyframes busyPulse {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 0.9; }
        }
        
        /* Watermark "ALREADY BOOKED" - Red Stamp Style */
        .slot-btn--busy::after {
            content: 'BOOKED';
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%) rotate(var(--rot, -5deg));
            font-size: 1.2rem; 
            font-weight: 900;
            color: rgba(255, 255, 255, 1); 
            border: 2.5px solid rgba(255, 255, 255, 1); 
            padding: 5px 12px;
            white-space: nowrap;
            pointer-events: none;
            letter-spacing: 1px;
            text-align: center;
            opacity: 1;
        }
        .slot-btn:hover::after {
            color: var(--accent-gold);
            border-color: var(--accent-gold);
        }


        @keyframes slideUpFade {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Sequential Glow Animation - modified for a unified cyclic wave */
        /* Sequential Glow Animation - brighter */
        @keyframes sequentialGlow {
            0%, 30%, 100% { 
                background: rgba(255, 255, 255, 0.05); 
                box-shadow: 0 0 0 rgba(255, 255, 255, 0);
            }
            15% { 
                background: rgba(255, 255, 255, 0.35); /* Brighter pulse */
                box-shadow: 0 0 15px rgba(255, 255, 255, 0.4);
            }
        }

        .slot-btn--hypnotic {
            animation: 
                slideUpFade 0.8s ease backwards calc(var(--i) * 0.1s),
                sequentialGlow 10s infinite ease-in-out calc(var(--i) * 0.2s); /* Increased to 10s */
        }

        @keyframes rotateIcon {
            0% { transform: rotate(0deg); }
            30% { transform: rotate(360deg); }
            100% { transform: rotate(360deg); }
        }

        .slot-icon-wrapper {
            display: inline-block;
            line-height: 0;
        }

        .slot-btn--hypnotic .slot-icon-wrapper {
            animation: rotateIcon 10s infinite ease-in-out calc(var(--i) * 0.2s);
        }


        /* Breathing Glow Animation */
        @keyframes breathingGlow {
            0% { 
                text-shadow: 0 0 5px rgba(255, 255, 255, 0.2); 
                opacity: 0.6; 
            }
            50% { 
                text-shadow: 0 0 20px rgba(255, 255, 255, 0.8), 0 0 10px rgba(255, 255, 255, 0.6); 
                opacity: 1; 
                color: #fff; 
            }
            100% { 
                text-shadow: 0 0 5px rgba(255, 255, 255, 0.2); 
                opacity: 0.6; 
            }
        }

        /* Loader */
        .calendar-loader {
            text-align: center;
            padding: 50px;
            font-weight: 700;
            color: rgba(255,255,255,0.6);
            display: none;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            animation: breathingGlow 2s infinite ease-in-out;
        }
        /* Modal Specific Input Styles */
        .modal .contact-form__input,
        .modal .contact-form__textarea {
            text-align: left; /* Left align on all devices */
        }
        .modal .contact-form__input::placeholder,
        .modal .contact-form__textarea::placeholder {
            font-size: 0.8rem;
            opacity: 0.7;
            text-align: left;
        }



        /* Next Available Message */
        .next-available-msg {
            text-align: center;
            margin-top: 20px;
            font-size: 1rem;
            color: #fff;
            font-weight: 700;
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        .next-available-msg--visible { opacity: 1; }

        /* File Attachment Styles */
        .file-attach {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            margin-top: 5px;
        }

        .file-attach__btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            width: 100%;
            padding: 16px;
            background: rgba(255, 255, 255, 0.08);
            border: 1px dashed rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            color: rgba(255, 255, 255, 0.7);
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: inherit;
            font-size: 0.95rem;
            font-weight: 600;
        }

        .file-attach__btn:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.5);
            color: #fff;
        }

        /* Paperclip Attention Animation */
        @keyframes paperclipAttention {
            0%, 90% { transform: rotate(0deg); }
            92% { transform: rotate(-25deg); }
            94% { transform: rotate(20deg); }
            96% { transform: rotate(-15deg); }
            98% { transform: rotate(5deg); }
            100% { transform: rotate(0deg); }
        }

        .file-attach__icon-svg {
            display: inline-block;
            transform-origin: center center;
            animation: paperclipAttention 10s infinite ease-in-out;
        }

        .file-attach__icon {
            font-size: 1.6rem;
            line-height: 1;
            display: flex;
        }

        .file-attach__list {
            width: 100%;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .file-attach__item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px 14px;
            background: rgba(255, 255, 255, 0.08);
            border-radius: 8px;
            font-size: 0.85rem;
            color: rgba(255, 255, 255, 0.9);
            position: relative;
            overflow: hidden;
        }

        .file-attach__name {
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            max-width: 80%;
        }

        .file-attach__remove {
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.5);
            cursor: pointer;
            font-size: 1.2rem;
            padding: 0 4px;
            transition: color 0.3s;
        }

        .file-attach__remove:hover {
            color: #ff6b6b;
        }

        .file-attach__progress {
            position: absolute;
            bottom: 0;
            left: 0;
            height: 3px;
            background: rgba(255, 255, 255, 0.6);
            width: 0%;
            transition: width 0.5s ease-out;
        }

        /* Custom Dropdown (Select Replacement) */
        .custom-select-wrapper {
            position: relative;
            user-select: none;
            width: 100%;
            margin-bottom: 20px;
        }

        .custom-select {
            position: relative;
            display: flex;
            flex-direction: column;
        }

        .custom-select__trigger {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 14px 25px;
            padding-right: 45px; /* Space for arrow */
            font-size: 1rem;
            color: rgba(80, 60, 40, 0.9);
            background: rgba(255, 255, 255, 0.95);
            border: none;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-sizing: border-box;
        }

        /* Arrow indicator */
        .custom-select__trigger::after {
            content: '';
            position: absolute;
            right: 18px;
            top: 50%;
            transform: translateY(-50%);
            width: 16px; height: 16px;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%238B6F5A' stroke-width='3' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-size: contain;
            transition: transform 0.3s ease;
        }

        .custom-select.open .custom-select__trigger {
            background: rgba(139, 111, 90, 0.8);
            color: #ffffff;
        }

        .custom-select.open .custom-select__trigger::after {
            transform: translateY(-50%) rotate(180deg);
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%23ffffff' stroke-width='3' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
        }

        .custom-select__trigger span {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .custom-options {
            position: absolute;
            display: block;
            top: 100%;
            left: 0; right: 0;
            background: rgba(255, 255, 255, 0.97);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: none;
            border-radius: 25px; /* All corners rounded */
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            z-index: 100;
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
            transform: translateY(0);
            transition: all 0.3s ease;
            max-height: none;
            overflow: visible;
            padding: 8px 0;
        }

        .custom-select.open .custom-options {
            opacity: 1;
            visibility: visible;
            pointer-events: all;
            transform: translateY(0);
        }

        .custom-option {
            position: relative;
            display: block;
            padding: 12px 25px;
            font-size: 1rem;
            color: rgba(80, 60, 40, 0.85);
            cursor: pointer;
            transition: background 0.2s;
            text-align: left;
        }

        .custom-option:hover, 
        .custom-option.selected {
            background-color: rgba(139, 111, 90, 0.12);
            color: #3a2a1a;
        }

        .custom-option.selected::after {
            content: '\2713';
            position: absolute;
            right: 18px; top: 50%;
            transform: translateY(-50%);
            color: var(--accent-gold);
        }

        /* Sparks Animation for Footer Booking Button */
        @keyframes sparkle {
            0%, 100% { opacity: 0; transform: scale(0) translate(var(--tx), var(--ty)); }
            50% { opacity: 1; transform: scale(1) translate(var(--tx), var(--ty)); }
        }

        .footer-book-btn {
            position: relative;
            display: inline-block;
            padding: 10px 20px;
            background: transparent;
            color: #fff;
            font-size: 0.9rem;
            font-weight: 700;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            text-decoration: none;
            text-align: center;
            margin: 15px auto;
            overflow: visible;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            isolation: isolate;
        }
        .footer-book-btn::before {
            content: '';
            position: absolute;
            inset: 0;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 50px;
            border: none;
            z-index: -1;
            transition: background 0.2s;
        }
        .footer-book-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 12px 35px rgba(0, 0, 0, 0.15);
        }
        .footer-book-btn:hover::before {
            background: rgba(255, 255, 255, 0.05);
        }

        #headerBookBtn {
            padding: 25px 40px !important;
            font-size: 1.3rem !important;
            width: auto !important;
            max-width: 90% !important;
        }

        .spark {
            position: absolute;
            width: 6px; height: 6px;
            border-radius: 50%;
            pointer-events: none;
            opacity: 0;
            animation: sparkle 1.2s ease-in-out infinite;
            background: #ffffff;
            z-index: -2;
        }

        @keyframes hypnoticPulse {
            0% { text-shadow: 0 0 5px rgba(255, 255, 255, 0.2); opacity: 0.6; }
            50% { text-shadow: 0 0 20px rgba(255, 255, 255, 0.9), 0 0 10px rgba(255, 255, 255, 0.7); opacity: 1; color: #fff; }
            100% { text-shadow: 0 0 5px rgba(255, 255, 255, 0.2); opacity: 0.6; }
        }

        .hypnotic-text {
            animation: hypnoticPulse 1.5s infinite ease-in-out;
        }

        /* Day Navigation in Slots Section */
        .slots-nav {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 40px 0; /* Increased vertical margin for centering */
            padding: 0 10px;
            width: 100%;
        }

        .slots-nav--loading .slots-nav-arrow {
            display: none;
        }

        .slots-nav-arrow {
            background: rgba(255, 255, 255, 0);
            border: none;
            color: #ffffff;
            font-size: 1.8rem; /* Consistent with calendar nav */
            cursor: pointer;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s ease;
            opacity: 0.7;
            user-select: none;
            padding: 0;
            line-height: 1;
        }

        .slots-nav-arrow:hover {
            background: rgba(255, 255, 255, 0.1);
            opacity: 1;
            transform: scale(1.1);
        }

        .slots-nav-arrow:active {
            transform: scale(0.95);
        }

        #slotsDayDisplay {
            font-size: 1.6rem;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: #ffffff;
            text-shadow: 0 1px 1px rgba(0,0,0,0.1);
            text-align: center;
            flex-grow: 1;
            margin: 0;
            transition: opacity 0.5s ease, transform 0.5s ease;
            line-height: 1.2;
        }

        .dot-jump {
            display: inline-block;
            animation: dotJump 1.4s infinite ease-in-out both;
        }
        .dot-jump:nth-child(2) { animation-delay: 0.2s; }
        .dot-jump:nth-child(3) { animation-delay: 0.4s; }

        @keyframes dotJump {
            0%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
        }

        .fade-out {
            opacity: 0;
            transform: translateY(-10px);
        }
        .fade-in {
            opacity: 1;
            transform: translateY(0);
        }

        /* Hide Spinners on Number Inputs */
        input[type=number]::-webkit-inner-spin-button, 
        input[type=number]::-webkit-outer-spin-button { 
            -webkit-appearance: none; 
            margin: 0; 
        }
        input[type=number] {
            appearance: textfield;
            -moz-appearance: textfield;
        }

        /* Playful Jump Animation for Last Slot Text */
        @keyframes playfulJump {
            0%, 30%, 100% { transform: scale(1); }
            15% { transform: scale(1.02); }
        }

        /* ------------------- TOP BAR & NAVIGATION (Auto-hiding) ------------------- */
        .top-bar {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 50px;
            height: 120px;
            background: rgba(255, 255, 255, 0.01);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            z-index: 10000;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding: 15px 20px 0;
            border-bottom: 1px solid var(--glass-border);
            opacity: 0;
            transform: translateY(-100%);
            pointer-events: none;
            transition: opacity 0.5s ease, transform 0.5s ease;
            -webkit-mask-image: linear-gradient(to bottom, black, transparent);
            mask-image: linear-gradient(to bottom, black, transparent);
        }

        .top-bar--visible {
            opacity: 1;
            transform: translateY(0);
            pointer-events: auto;
            transition: opacity 1.5s ease-out, transform 1.5s ease-out;
        }

        /* ------------------- THEME SWITCH (Inside Top Bar) ------------------- */
        .theme-switch-wrapper {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .theme-switch {
            display: inline-block;
            height: 30px;
            position: relative;
            width: 52px;
        }
        .theme-switch input { display: none; }
        .slider {
            background-color: rgba(0, 0, 0, 0.2);
            bottom: 0; cursor: pointer; left: 0; position: absolute; right: 0; top: 0;
            transition: .4s; border-radius: 34px; backdrop-filter: blur(5px);
            border: 1px solid rgba(255,255,255,0.2);
        }
        .slider:before {
            background-color: #fff; bottom: 3px; content: ""; height: 22px; left: 3px;
            position: absolute; transition: .4s; width: 22px; border-radius: 50%;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        input:checked + .slider {
            background-color: #8e8e93;
        }
        input:checked + .slider:before {
            transform: translateX(24px);
        }
        .theme-wrapper-icon {
            width: 20px;
            height: 20px;
            stroke: #fff;
            opacity: 0.7;
        }

        /* ------------------- LANGUAGE SWITCHER ------------------- */
        .lang-switcher {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .lang-btn {
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.9rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 5px;
        }

        .lang-btn:hover, .lang-btn.active {
            color: #ffffff;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }

        /* ------------------- BLACK THEME OVERRIDES ------------------- */
        [data-theme="black"] {
            --bg-dark: #000000;
            --text-white: #d1d1d1;
            --glass-bg: rgba(30, 30, 30, 0.6);
            --glass-border: rgba(255, 255, 255, 0.15);
            --input-bg: rgba(255, 255, 255, 0.1);
            --accent-gold: #aaaaaa; /* Was #D4B89A */
            --accent-hover: #999999;
            --placeholder-color: #777777;
            scrollbar-color: #444 transparent;
        }
        [data-theme="black"] .background__svg rect {
            fill: #000000 !important;
        }
        [data-theme="black"] body::-webkit-scrollbar-thumb { background-color: #444; }
        [data-theme="black"] body::-webkit-scrollbar-thumb:hover { background-color: #666; }
        [data-theme="black"] .background__stripe {
            opacity: 0.1;
            fill: #ffffff;
        }
        [data-theme="black"] .calendar-wrapper {
            background: rgba(20, 20, 20, 0.6);
            border-color: rgba(255, 255, 255, 0.1);
        }
        [data-theme="black"] .cal-day {
            background: rgba(255, 255, 255, 0.08);
            color: #ddd;
        }
        [data-theme="black"] .cal-day--selected {
            background: #ffffff !important;
            color: #000000 !important;
        }
        [data-theme="black"] .slot-btn {
            background: rgba(255, 255, 255, 0.08);
        }
        [data-theme="black"] .modal__content {
            background: #121212;
        }
        [data-theme="black"] .map-container__iframe {
            filter: grayscale(1) invert(1);
        }
        [data-theme="black"] .contact-form__input::placeholder,
        [data-theme="black"] .contact-form__textarea::placeholder {
            color: var(--placeholder-color);
        }
        [data-theme="black"] .contact-form__input:focus,
        [data-theme="black"] .contact-form__textarea:focus,
        [data-theme="black"] .contact-form__input--has-content {
            color: #000000;
        }
        [data-theme="black"] .contact-form__submit-button,
        [data-theme="black"] .footer__button,
        [data-theme="black"] .contact-form__booking-wrapper button {
            background: #333333 !important;
        }
        [data-theme="black"] .contact-form__submit-button:hover,
        [data-theme="black"] .footer__button:hover,
        [data-theme="black"] .contact-form__booking-wrapper button:hover {
            background: #555555 !important;
        }
        [data-theme="black"] .contact-form__terms-link:hover {
            color: #cccccc;
        }
        [data-theme="black"] .faq__question::before {
            border-color: #888;
        }
        [data-theme="black"] details[open] > .faq__question::before {
            background-color: #888;
        }
        [data-theme="black"] .faq__answer svg path[fill="#5a3d2a"] {
            fill: #555555;
        }
        [data-theme="black"] .custom-select__trigger {
            background: #222;
            color: #ddd;
        }
        [data-theme="black"] .custom-select__trigger::after {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%23eeeeee' stroke-width='3' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
        }
        [data-theme="black"] .custom-select.open .custom-select__trigger {
            background: #444;
            color: #fff;
        }
        [data-theme="black"] .custom-select.open .custom-select__trigger::after {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%23ffffff' stroke-width='3' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
        }
        [data-theme="black"] .custom-options {
            background: #222;
        }
        [data-theme="black"] .custom-option {
            color: #ddd;
        }
        [data-theme="black"] .custom-option:hover,
        [data-theme="black"] .custom-option.selected {
            background-color: #444;
            color: #fff;
        }
        [data-theme="black"] .custom-option.selected::after {
            color: #fff;
        }
        [data-theme="black"] .top-bar {
            background: rgba(20, 20, 20, 0.6);
        }

        /* Preloader for Book Button */
        .book-btn-preloader {
            display: grid;
            place-items: center;
            width: 180px;
            height: 180px;
            position: relative;
            margin: 15px auto;
            transition: opacity 0.5s ease, transform 0.5s ease;
        }

        .book-btn-preloader__text {
            font-size: 1rem;
            font-weight: 700;
            color: #fff;
            text-shadow: 0 1px 2px rgba(0,0,0,0.2);
            text-align: center;
            line-height: 1.3;
            z-index: 2;
            position: relative;
        }

        .book-btn-preloader__svg {
            position: absolute;
            top: 0; left: 0;
            width: 100%;
            height: 100%;
            transform: rotate(-90deg); /* Start from top */
        }

        .book-btn-preloader__circle {
            fill: transparent;
            stroke: rgba(255, 255, 255, 0.2);
            stroke-width: 12;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        .book-btn-preloader__progress {
            fill: none;
            stroke: #ffffff;
            stroke-width: 12;
            stroke-linecap: round;
            stroke-dasharray: 302; /* Circumference: 2 * pi * 48 */
            stroke-dashoffset: 302; 
            animation: fillProgress 14s ease-out forwards; /* 14 seconds, one time */
        }

        @keyframes fillProgress {
            0% { stroke-dashoffset: 302; }
            100% { stroke-dashoffset: 0; } 
        }

        .book-btn-container {
            position: relative;
            height: 180px; /* Adjust height to fit preloader */
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* ================= MOBILE RESPONSIVE STYLES ================= */
        @media (max-width: 768px) {
            /* Header */
            .header { 
                padding: 30px 15px 5px; 
            }

            .header__title { 
                font-size: 2.5rem; 
                margin-bottom: 5px;
            }

            .header__subtitle { 
                font-size: 1.8rem; 
                margin-bottom: 3px;
            }

            .header__contact {
                margin: 10px 0;
                gap: 8px;
            }

            .header__contact-label {
                font-size: 1rem;
            }

            .header__phone-link { 
                font-size: 1.4rem; 
            }

            .header__seo-text {
                font-size: 0.9rem;
                margin: 10px auto;
                max-width: 95%;
            }

            /* Layout Container */
            .layout-container { 
                max-width: 100%;
                padding: 8px 15px 15px; 
            }

            /* Form Styling */
            .contact-form__outside-title { 
                font-size: 1.2rem; 
                margin-bottom: 15px; 
            }

            .contact-form__group { 
                margin-bottom: 18px; 
            }

            .contact-form__label { 
                font-size: 0.75rem; 
            }

            .contact-form__input, 
            .contact-form__textarea, 
            .contact-form__select { 
                padding: 12px; 
                font-size: 16px; /* Prevents zoom on iOS */
            }

            .contact-form__textarea { 
                min-height: 140px; 
            }

            .contact-form__submit-button { 
                padding: 16px; 
                font-size: 0.95rem; 
            }

            /* Section Title */
            .section-title { 
                font-size: 1.3rem;
                margin-bottom: 20px; 
                margin-top: 20px;
            }

            /* FAQ */
            .faq__question { 
                font-size: 0.95rem; 
                gap: 12px; 
            }

            .faq__answer { 
                font-size: 0.85rem;
                padding-left: 24px; 
            }

            /* Calendar */
            .calendar-wrapper {
                padding: 20px;
                margin-top: 3px;
            }

            .calendar-title {
                font-size: 1rem;
            }

            .calendar-title .cal-month { 
                font-size: 1.2rem; 
            }
            
            .calendar-title .cal-year { 
                font-size: 1.2rem; 
                margin-top: -3px; 
            }

            .calendar-nav-btn {
                width: 40px;
                height: 40px;
                font-size: 1.4rem;
            }

            .calendar-grid {
                gap: 8px;
            }

            .cal-day-name {
                font-size: 0.65rem;
                margin-bottom: 3px;
            }

            .cal-day {
                font-size: 0.85rem;
                border-radius: 10px;
            }

            /* Slots */
            .slots-title {
                font-size: 1rem;
                margin-bottom: 18px;
            }

            .slots-grid {
                gap: 10px;
            }

            .slot-btn {
                padding: 14px 12px;
                font-size: 0.8rem;
                gap: 8px;
            }

            .slot-btn--busy::after {
                font-size: 0.9rem;
                padding: 4px 10px;
            }

            .slots-nav {
                margin: 30px 0;
            }

            .slots-nav-arrow {
                font-size: 1.4rem;
                width: 40px;
                height: 40px;
            }

            #slotsDayDisplay {
                font-size: 1.2rem;
            }

            /* Footer */
            .footer {
                padding: 20px 15px;
                font-size: 0.8rem;
            }

            .footer__button {
                padding: 16px;
                font-size: 0.95rem;
                max-width: 90%;
            }

            .footer__contact-link {
                font-size: 1.4rem;
                margin-bottom: 3px;
                margin-top: 15px;
            }

            .footer__hours {
                font-size: 0.8rem;
            }

            /* Modal */
            .modal {
                padding: 5px;
            }

            .modal__content {
                padding: 25px;
                max-width: 95%;
                max-height: 95vh;
            }

            .modal__title {
                font-size: 1.1rem;
                margin-bottom: 12px;
            }

            .modal__body {
                font-size: 0.85rem;
                line-height: 1.6;
            }

            .modal__section-title {
                font-size: 1rem;
                margin-top: 15px;
                margin-bottom: 8px;
            }

            .modal__footer-text {
                font-size: 0.9rem;
                margin-top: 20px;
                padding-top: 15px;
            }

            #termsModal .modal__title {
                font-size: 1.6rem;
            }

            #termsModal .modal__section-title {
                font-size: 1rem;
            }

            /* Custom Select */
            .custom-select__trigger {
                padding: 12px 20px;
                padding-right: 40px;
                font-size: 0.95rem;
            }

            .custom-option {
                padding: 10px 20px;
                font-size: 0.95rem;
            }

            /* File Attach */
            .file-attach__btn {
                padding: 12px;
                font-size: 0.85rem;
            }

            .file-attach__icon {
                font-size: 1.2rem;
            }

            .file-attach__item {
                padding: 8px 10px;
                font-size: 0.75rem;
            }
        }

        /* Small Mobile Phones (max-width: 480px) */
        @media (max-width: 480px) {
            .header { 
                padding: 20px 10px 5px; 
            }

            .header__title { 
                font-size: 1.8rem; 
            }

            .header__subtitle { 
                font-size: 1.3rem; 
            }

            .header__contact {
                margin: 8px 0;
                gap: 6px;
            }

            .header__contact-label {
                font-size: 0.85rem;
            }

            .header__phone-link { 
                font-size: 1.1rem; 
            }

            .header__seo-text {
                font-size: 0.8rem;
                margin: 8px auto;
            }

            .layout-container { 
                padding: 6px 10px 12px; 
            }

            .contact-form__outside-title { 
                font-size: 1rem; 
                margin-bottom: 12px; 
            }

            .contact-form__group { 
                margin-bottom: 15px; 
            }

            .contact-form__label { 
                font-size: 0.7rem; 
            }

            .contact-form__input, 
            .contact-form__textarea, 
            .contact-form__select { 
                padding: 10px; 
            }

            .contact-form__textarea { 
                min-height: 120px; 
            }

            .contact-form__submit-button { 
                padding: 14px; 
                font-size: 0.85rem; 
            }

            .section-title { 
                font-size: 1.1rem;
                margin-bottom: 15px; 
                margin-top: 15px;
            }

            .faq__question { 
                font-size: 0.85rem; 
                gap: 10px; 
            }

            .faq__answer { 
                font-size: 0.75rem;
                padding-left: 20px; 
                padding-bottom: 15px;
            }

            .calendar-wrapper {
                padding: 15px;
            }

            .calendar-title {
                font-size: 0.9rem;
            }

            .calendar-title .cal-month { 
                font-size: 1rem; 
            }
            
            .calendar-title .cal-year { 
                font-size: 1rem; 
                margin-top: -2px; 
            }

            .calendar-nav-btn {
                width: 35px;
                height: 35px;
                font-size: 1.2rem;
            }

            .calendar-grid {
                gap: 6px;
            }

            .cal-day-name {
                font-size: 0.6rem;
                margin-bottom: 2px;
            }

            .cal-day {
                font-size: 0.75rem;
                border-radius: 8px;
            }

            .slots-title {
                font-size: 0.9rem;
                margin-bottom: 15px;
            }

            .slots-grid {
                grid-template-columns: 1fr; /* Single column on very small screens */
                gap: 8px;
            }

            .slot-btn {
                padding: 12px 10px;
                font-size: 0.75rem;
                gap: 6px;
            }

            .slot-btn--busy::after {
                font-size: 0.8rem;
                padding: 3px 8px;
            }

            .slots-nav {
                margin: 25px 0;
            }

            .slots-nav-arrow {
                font-size: 1.2rem;
                width: 35px;
                height: 35px;
            }

            #slotsDayDisplay {
                font-size: 1rem;
            }

            .footer {
                padding: 15px 10px;
                font-size: 0.7rem;
            }

            .footer__button {
                padding: 14px;
                font-size: 0.85rem;
                max-width: 95%;
            }

            .footer__contact-link {
                font-size: 1.2rem;
                margin-bottom: 2px;
                margin-top: 12px;
            }

            .footer__hours {
                font-size: 0.75rem;
            }

            .modal__content {
                padding: 20px;
                max-width: 98%;
            }

            .modal__title {
                font-size: 1rem;
                margin-bottom: 10px;
            }

            .modal__body {
                font-size: 0.8rem;
                line-height: 1.5;
            }

            .modal__section-title {
                font-size: 0.9rem;
                margin-top: 12px;
                margin-bottom: 6px;
            }

            .modal__footer-text {
                font-size: 0.8rem;
                margin-top: 15px;
                padding-top: 12px;
            }

            #termsModal .modal__title {
                font-size: 1.4rem;
            }

            #termsModal .modal__section-title {
                font-size: 0.9rem;
            }

            .custom-select__trigger {
                padding: 10px 18px;
                padding-right: 35px;
                font-size: 0.9rem;
            }

            .custom-option {
                padding: 9px 18px;
                font-size: 0.9rem;
            }

            .file-attach__btn {
                padding: 10px;
                font-size: 0.75rem;
            }

            .file-attach__icon {
                font-size: 1rem;
            }

            .file-attach__item {
                padding: 6px 8px;
                font-size: 0.7rem;
            }
        }
    </style>
</head>

<body id="top">

<!-- TOP BAR -->
<div class="top-bar">
    <!-- Theme Switch (Left) -->
    <div class="theme-switch-wrapper">
        <!-- Sun icon -->
        <svg class="theme-wrapper-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>
        <label class="theme-switch" for="checkbox">
            <input type="checkbox" id="checkbox">
            <div class="slider round"></div>
        </label>
        <!-- Moon icon -->
        <svg class="theme-wrapper-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
    </div>

    <!-- Language Switcher (Right) -->
    <div class="lang-switcher">
        <button class="lang-btn active" onclick="setLanguage('en')">EN</button>
        <button class="lang-btn" onclick="setLanguage('fr')">FR</button>
        <button class="lang-btn" onclick="setLanguage('ua')">UA</button>
        <button class="lang-btn" onclick="setLanguage('ru')">RU</button>
        <button class="lang-btn" onclick="setLanguage('ch')">CH</button>
    </div>
</div>

<div class="background">
    <svg class="background__svg" viewBox="0 0 528 816" preserveAspectRatio="xMidYMid slice">
        <defs>
            <radialGradient id="g" cx="50%" cy="100%" r="100%">
                <stop offset="0" stop-color="#D4B89A"/><stop offset="1" stop-color="#8B6F5A"/>
            </radialGradient>
        </defs>
        <rect width="100%" height="100%" fill="url(#g)"/>
        <g style="mix-blend-mode:overlay" fill-opacity=".15">
            <path class="background__stripe" d="M-100 300L600-100V200L-100 600Z" fill="#fff"/>
            <path class="background__stripe background__stripe--delay-1" d="M-100 700L600 200V400L-100 900Z" fill="#000" fill-opacity=".2"/>
            <path class="background__stripe background__stripe--delay-2" d="M100-100L500 900H300L-100-100Z" fill="#fff" fill-opacity=".08"/>
        </g>
    </svg>
</div>

<header class="header">
    <div class="header__title dynamic-text" data-i18n="name">Hanna Dunchenko</div>
    <div class="header__subtitle dynamic-text" data-i18n="subtitle">Paralegal Services</div>
    <h1 class="header__seo-text">
        <span class="header__seo-line dynamic-text" data-i18n="seo1">Licensed Paralegal &amp; Notary Public Services </span>
        <span class="header__seo-line dynamic-text" data-i18n="seo2">Traffic Ticket Defense, LTB, WSIB Matters </span>
        <span class="header__seo-line dynamic-text" data-i18n="seo3">Toronto, Richmond Hill, Mississauga, London </span>
        <span class="header__seo-line dynamic-text" data-i18n="seo4">All online consultations are available province-wide </span>
    </h1>
</header>



<div class="layout-container">
    <!-- Header Available Slot Button -->
    <div style="text-align: center; margin-bottom: 15px;">
    <div style="text-align: center; margin-bottom: 15px; margin-top: 0;">
        <!-- Container for preloader and button to manage smooth transition -->
        <div class="book-btn-container">
            <div class="book-btn-preloader" id="headerBookBtnPreloader" style="position: absolute;">
                <svg class="book-btn-preloader__svg" viewBox="0 0 120 120">
                    <circle class="book-btn-preloader__circle" cx="60" cy="60" r="48"/>
                    <circle class="book-btn-preloader__progress" cx="60" cy="60" r="48"/>
                </svg>
            </div>
            <button class="footer-book-btn" id="headerBookBtn" onclick="bookNearestSlot()" style="opacity: 0; transform: scale(0.9); pointer-events: none;">
            <span id="headerBookBtnText" data-i18n="bookBtn">Book Your First<br>Available Appointment</span>
        </button>
    </div>
    <div class="header__contact">
        <a href="tel:+14372396833" class="header__phone-link dynamic-text">+1 (437) 239-6833</a>
    </div>
    <div class="contact-form">
        <!-- Custom Booking Calendar -->
        <div class="calendar-wrapper" id="bookingCalendar">
            
            <!-- Header Moved to Top -->
            <div class="calendar-header">
                <button class="calendar-nav-btn" id="prevBtn">&#10094;</button>
                <div class="calendar-title" id="monthDisplay">Month Year</div>
                <button class="calendar-nav-btn" id="nextBtn">&#10095;</button>
            </div>

            <!-- Progress bar -->
            <div id="loadingSeparator" class="loading-separator"></div>

            <!-- Slots Container moved BELOW -->
            <!-- <div class="slots-container" id="slotsContainer">...</div> (Moved down) -->

            <div id="calendarLoader" class="calendar-loader">Loading availability...</div>

            <div class="calendar-grid" id="calendarGrid">
                <!-- Days will be injected here -->
            </div>
            
            <div id="nextAvailableMsg" class="next-available-msg"></div>

            <!-- Slots moved here -->
             <!-- Slots moved here -->
             <div class="slots-container" id="slotsContainer">
                
                <!-- Day Navigation Header -->
                <div class="slots-nav slots-nav--loading">
                    <span id="slotsDayDisplay" class="hypnotic-text">Connecting to server<span class="dot-jump">.</span><span class="dot-jump">.</span><span class="dot-jump">.</span></span>
                </div>

                <!-- Title removed per request -->
                <!-- <h3 class="slots-title">Tap on time you need</h3> -->
                <div class="slots-grid" id="slotsGrid" style="grid-template-columns: 1fr; /* Full width buttons for detailed text */">
                    <!-- Removing Connecting text -->
                </div>
                <div id="calCtaMsg" class="cal-cta" style="margin-top: 30px; text-align: center; font-weight: 700; display: none; width: 100%;">Choose your day and slot</div>
            </div>
            
            <!-- Instruction below slots -->
            <!-- Removed Instruction 'Please select a time slot now.' -->

            <!-- Removed instruction text per "Убери надпись Just click..." request -->
            
        </div>
        <!-- End Custom Booking Calendar -->
    </div>

    <h2 class="section-title" data-i18n="faqTitle">FAQ</h2>
    <div class="faq">
        <details class="faq__item" open>
             <summary class="faq__question" data-i18n="faq1q">What are the keys on the calendar?</summary>
             <div class="faq__answer" data-i18n="faq1a">
              <div id="coffeeCups" style="position: relative; display: inline-block; cursor: pointer;">
                 The keys on the calendar above indicate that the office is closed on those days. Meetings may still be arranged by appointment. If required, we can attend together, open the office, and proceed with the consultation to outline strategy and next steps. Where appropriate, discussions may take place in a more relaxed setting, with some coffee & milk
                 <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA2MCA0MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48c3R5bGU+LnN7YW5pbWF0aW9uOnIgM3MgaW5maW5pdGUgZWFzZS1vdXQ7b3BhY2l0eTowO3N0cm9rZTojZmZmO2ZpbGw6bm9uZTtzdHJva2Utd2lkdGg6MS41O3N0cm9rZS1saW5lY2FwOnJvdW5kfUBrZXlmcmFtZXMgcnswJXt0cmFuc2Zvcm06dHJhbnNsYXRlWSgwKTtvcGFjaXR5OjB9MjAle29wYWNpdHk6LjZ9MTAwJXt0cmFuc2Zvcm06dHJhbnNsYXRlWSgtMTVweCk7b3BhY2l0eTowfX08L3N0eWxlPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDUsMTgpIj48cGF0aCBkPSJNMCAwaDE0djVhNyA3IDAgMCAxLTE0IDBWMHoiIGZpbGw9IiNhMTg1NzAiIHN0cm9rZT0iI2ZmZiIgc3Ryb2tlLXdpZHRoPSIxLjUiLz48cGF0aCBkPSJNMTQgMmgzYTIgMiAwIDAgMSAwIDRoLTMiIHN0cm9rZT0iI2ZmZiIgc3Ryb2tlLXdpZHRoPSIxLjUiIGZpbGw9Im5vbmUiLz48cGF0aCBjbGFzcz0icyIgZD0iTTQgLTJxMyAtNSAwIC04IiBzdHlsZT0iYW5pbWF0aW9uLWRlbGF5OjBzIi8+PHBhdGggY2xhc3M9InMiIGQ9Ik0xMCAtMnEzIC01IDAgLTgiIHN0eWxlPSJhbmltYXRpb24tZGVsYXk6MS41cyIvPjwvZz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzNSwxOCkiPjxwYXRoIGQ9Ik0wIDBoMTR2NWE3IDcgMCAwIDEtMTQgMFYweiIgZmlsbD0iI2ExODU3MCIgc3Ryb2tlPSIjZmZmIiBzdHJva2Utd2lkdGg9IjEuNSIvPjxwYXRoIGQ9Ik0xNCAyaDNhMiAyIDAgMCAxIDAgNGgtMyIgc3Ryb2tlPSIjZmZmIiBzdHJva2Utd2lkdGg9IjEuNSIgZmlsbD0ibm9uZSIvPjxwYXRoIGNsYXNzPSJzIiBkPSJNNCAtMnEzIC01IDAgLTgiIHN0eWxlPSJhbmltYXRpb24tZGVsYXk6LjVzIi8+PHBhdGggY2xhc3M9InMiIGQ9Ik0xMCAtMnEzIC01IDAgLTgiIHN0eWxlPSJhbmltYXRpb24tZGVsYXk6MnMiLz48L2c+PC9zdmc+" alt="Coffee Cups" style="vertical-align: middle; margin-left: 5px;">
                  <svg id="heartAnimation" width="30" height="30" viewBox="0 0 24 24" fill="white" style="position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%) scale(0); transition: transform 0.3s ease, opacity 0.3s ease; opacity: 0;">
                    <path d="M12 21.35L10.55 20.03C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
                  </svg>
              </div>
             </div>
        </details>

        <details class="faq__item" open>
            <summary class="faq__question" data-i18n="faq2q">ARE FEES THE SAME ON SATURDAYS?</summary>
            <div class="faq__answer" data-i18n="faq2a">
                Yes. Service fees remain unchanged. The only difference is that weekend appointments must be confirmed in advance by phone. This confirmation ensures that there are no conflicting appointments in the calendar regarding other scopes of practice.
            </div>
        </details>

        <details class="faq__item" open>
            <summary class="faq__question" data-i18n="faq3q">What forms are worked with?</summary>
            <div class="faq__answer" data-i18n="faq3a">
                <p>Enumeration provided strictly as examples and does not limit scope of practice.<br><br><strong>Traffic Ticket Defense:</strong> Forms Part I, Part II, Part III; <strong>Landlord and Tenant Board:</strong> Forms N1–N13, L1–L4, T1, T2, T6, Form 6, Form 7, Form 8; <strong>WSIB:</strong> Form 6, Form 7, Form 8, Functional Abilities Form, Construction Exposure Incident Report, Physician Progress Report, Noise-Induced Hearing Loss Form, Travel Expense Form; <strong>Notary Public:</strong> Application Form 004-0315e, Affidavits, Statutory Declarations, Certified Copies, Document Authentication.<br><br>Your files to be reviewed at appointment for determination of applicable documents. Attach all current documents now for assessment.</p>
            </div>
        </details>


       <details class="faq__item" open>
            <summary class="faq__question">Was there a registration here previously?</summary>
            <div class="faq__answer">Yes, we have a talented web designer and programmer that created a new design for our website! If you still want to use old form, click this: <a href="https://docs.google.com/forms/d/1brLzvNv2tR9jDvG4Z9vUZLvzzpgZHmOhHPZ7_x8g8Qo" style="color:white">Google Form</a></div>
       </details>





        <details class="faq__item" open>
            <summary class="faq__question" data-i18n="faq4q">Privacy Policy?</summary>
            <div class="faq__answer" data-i18n="faq4a">
                <p><strong>Data Collection:</strong> Personal details you submit (name, phone, email, case summary) are gathered through this form.</p>
                <p style="margin-top: 10px;"><strong>How It's Used:</strong> Your information helps deliver paralegal representation, answer your questions, and maintain contact (with your consent).</p>
                <p style="margin-top: 10px;"><strong>Your Rights:</strong> Request access to or removal of your data by calling <strong><a href="tel:+14372396833" style="color: #ffffff; text-decoration: none;">+1 (437) 239-6833</a></strong> or emailing <strong><a href="mailto:paralegal@hannadunchenko.com" style="color: #ffffff; text-decoration: none;">paralegal@hannadunchenko.com</a></strong>.</p>
            </div>
        </details>

        <details class="faq__item" open>
            <summary class="faq__question" data-i18n="faq5q">OK ! WHERE IS YOUR OFFICE?</summary>
            <div class="faq__answer">
                <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 15px; flex-wrap: wrap;">
                    <span style="opacity: 0.9; font-size: 0.95rem; display: inline-block;" data-i18n="faq5_tap">Just tap</span>
                    <a href="https://www.google.com/maps/dir//146+Thirtieth+St,+Etobicoke,+ON+M8W+3C4" target="_blank" style="display: inline-flex; align-items: center; gap: 6px; padding: 10px 20px; background: rgba(255, 255, 255, 0.15); border: 1px solid rgba(255, 255, 255, 0.3); backdrop-filter: blur(10px); box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1); color: #fff; font-weight: 700; border-radius: 50px; text-decoration: none; font-size: 0.9rem; white-space: nowrap; transition: transform 0.2s;" data-i18n="faq5directions">Directions</a>
                    <span style="opacity: 0.9; font-size: 0.95rem; display: inline-block;" data-i18n="faq5_driving">to start driving</span>
                </div>
                <div class="map-container">
                    <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d378393.2825310128!2d-80.40792372435779!3d43.21332219277207!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x882b362142436423%3A0x6a0532729e2f4772!2s146%20Thirtieth%20St%2C%20Etobicoke%2C%20ON%20M8W%203C4!5e0!3m2!1sen!2sca" class="map-container__iframe" allowfullscreen="" loading="eager"></iframe>
                </div>
            </div>
        </details>
    </div>
</div>

<!-- ----------------------------------------------------------- -->
<!-- TERMS OF SERVICE MODAL -->
<!-- ----------------------------------------------------------- -->
<div id="termsModal" class="modal">
    <div class="modal__content">
        <button class="modal__close" onclick="closeTermsModal()">&times;</button>
        <h2 class="modal__title" data-i18n="termsModalTitle">Terms of Service</h2>
        <div class="modal__body">
            <h3 class="modal__section-title" data-i18n="noLegalAdvice">1. No Legal Advice</h3>
            <p class="modal__text">The information provided on this website is for general informational purposes only and does not constitute legal advice. You should not rely on, or take or fail to take any action, based upon this information. Always seek the advice of a qualified legal professional licensed in your jurisdiction regarding your specific legal situation.</p>
            
            <h3 class="modal__section-title" data-i18n="noParalegalRelationship">2. No Paralegal-Client Relationship</h3>
            <p class="modal__text">Accessing or using this website, or contacting Hanna Dunchenko via email, phone, or the booking form, does not create a paralegal-client relationship. A professional relationship is only established upon the execution of a formal written Retainer Agreement signed by both parties.</p>
            
            <h3 class="modal__section-title" data-i18n="confidentiality">3. Confidentiality</h3>
            <p class="modal__text">While we respect your privacy, please be aware that information transmitted to us through this website or via email prior to the establishment of a formal paralegal-client relationship may not be privileged or confidential. Please avoid sending sensitive or confidential information until a retainer is in place.</p>
            
            <h3 class="modal__section-title" data-i18n="noGuarantee">4. No Guarantee of Results</h3>
            <p class="modal__text">In accordance with professional standards and applicable regulations, we do not and cannot guarantee the outcome of any legal matter. Past results are not indicative of future outcomes, and every case is unique.</p>
            
            <h3 class="modal__section-title" data-i18n="feesAndRetainers">5. Fees and Retainers</h3>
            <p class="modal__text">Fees for legal services are determined based on the scope and complexity of the matter and will be clearly outlined in a Retainer Agreement. All fees and billing practices comply with professional regulatory guidelines.</p>

            <h3 class="modal__section-title" data-i18n="limitationOfLiability">6. Limitation of Liability</h3>
            <p class="modal__text">Your use of this website is at your own risk. The content is provided "as is" without warranties of any kind. We are not liable for any damages arising from your use of this site.</p>

            <h3 class="modal__section-title" data-i18n="formSubmission">7. Form Submission & Response Disclaimer</h3>
            <p class="modal__text">Submitting the inquiry form on this website is for informational purposes only and allows us to review your case files. It does not guarantee that a case will be opened, nor does it guarantee a response. While we aim to reply within 48 hours, a response is not guaranteed, and no legal rights are preserved by the mere act of submission.</p>

            <h2 class="modal__title" style="margin-top: 50px; margin-bottom: 20px; font-size: 1.8rem;" data-i18n="privacyPolicy">Privacy Policy</h2>

            <h3 class="modal__section-title" data-i18n="infoCollection">1. Information Collection</h3>
            <p class="modal__text">We collect personal information (such as name and contact details) only when you voluntarily provide it. This information is used solely to communicate with you and assess your potential legal needs.</p>

            <h3 class="modal__section-title" data-i18n="useOfInfo">2. Use of Information</h3>
            <p class="modal__text">Your data is used to facilitate communication and legal representation. We do not sell, trade, or otherwise transfer your personally identifiable information to outside parties.</p>

            <h3 class="modal__section-title" data-i18n="analyticsAds">3. Analytics & Advertising</h3>
            <p class="modal__text">This website uses services like Google Analytics, Google Ads, YouTube, and Facebook. These third-party vendors may use cookies to analyze traffic, serve relevant advertisements based on past visits, and improve user experience. You may opt out of personalized advertising by visiting Google's Ad Settings.</p>

            <h3 class="modal__section-title" data-i18n="responseTime">4. Response Time</h3>
            <p class="modal__text">Please note that responses to your inquiry may take up to 48 business hours or longer. To expedite your request, we strongly recommend contacting our paralegal by phone immediately after submitting this form.</p>

            <h3 class="modal__section-title" data-i18n="contactUs">5. Contacting Us</h3>
            <p class="modal__text">If there are any questions regarding this privacy policy or if you wish to exercise your rights to access or delete your data, you may contact us at paralegal@hannadunchenko.com.</p>

            <p class="modal__footer-text">
                By using this website, you acknowledge that you have read and understood these Terms of Service.
            </p>
        </div>
    </div>
</div>

</div> 

<footer class="footer">
    <div class="footer__container">
        
        <div class="footer__hours" data-i18n="hours">
            <strong>Hours of Operation:</strong><br>Sunday: Closed<br>Monday - Saturday: 10:00 AM - 4:00 PM
        </div>

        <!-- Nearest Available Day Booking Button -->
        <div style="text-align: center; margin: 10px 0;">
            <div class="book-btn-container">
                <div class="book-btn-preloader" id="footerBookBtnPreloader" style="position: absolute;">
                    <svg class="book-btn-preloader__svg" viewBox="0 0 120 120">
                        <circle class="book-btn-preloader__circle" cx="60" cy="60" r="48"/>
                        <circle class="book-btn-preloader__progress" cx="60" cy="60" r="48"/>
                    </svg>
                </div>
                <button class="footer-book-btn" id="footerBookBtn" onclick="bookNearestSlot()" style="opacity: 0; transform: scale(0.9); pointer-events: none;">
                <span id="footerBookBtnText" data-i18n="bookBtn">Book Your First<br>Available Appointment</span>
            </button>
        </div>

        <a href="tel:+14372396833" class="footer__contact-link">+1 (437) 239-6833</a>
    </div>
    <p class="footer__copyright" data-i18n="copyright">&copy; 2026 Hanna Dunchenko Paralegal Services</p>
</footer>
</div> <!-- End blurContainer -->

<!-- BOOKING MODAL -->
<div id="bookingModal" class="modal">
    <div class="modal__content" style="max-width: 600px;">
        <button class="modal__close" onclick="closeBookingModal()" style="left: 20px; right: auto;">&times;</button>
        <h2 class="modal__title" style="text-align: center; margin-top: 10px; margin-bottom: 20px; padding-top: 0;">YOUR APPOINTMENT AT: <span id="modalAppointmentTime" style="display: block; font-size: 0.9em; font-weight: normal; margin-top: 5px;"></span></h2>
        <div class="modal__body" style="padding-top: 5px; text-align: center;">
            
            <form id="bookingForm" onsubmit="handleBookingSubmit(event)">
                <!-- Honeypot: hidden from humans, visible to bots -->
                <div style="position: absolute; left: -9999px; top: -9999px;" aria-hidden="true">
                    <input type="text" name="website" tabindex="-1" autocomplete="off">
                </div>
                <input type="hidden" name="_timestamp" id="formTimestamp">
                
                <div class="contact-form__group">
                    <input type="text" class="contact-form__input" placeholder="Your Name" name="name" required>
                </div>
                <div class="contact-form__group">
                    <input type="email" class="contact-form__input" placeholder="Your Email" name="email" required>
                </div>

                <div class="contact-form__group">
                    <!-- Custom Select Markup -->
                    <div class="custom-select-wrapper">
                        <div class="custom-select" id="customSelect">
                            <button class="custom-select__trigger" type="button">
                                <span>Choose Service</span>
                            </button>
                            <div class="custom-options">
                                <div class="custom-option" data-value="public-notary">Public Notary Services</div>
                                <div class="custom-option" data-value="employment">Employment Law</div>
                                <div class="custom-option" data-value="civil">Civil matter</div>
                                <div class="custom-option" data-value="wsib">WSIB related issue</div>
                                <div class="custom-option" data-value="ltb">LTB related issue</div>
                                <div class="custom-option" data-value="other">Other</div>
                            </div>
                        </div>
                        <input type="hidden" name="service" id="serviceInput" value="">
                    </div>
                </div>

                <div class="contact-form__group">
                    <input type="tel" class="contact-form__input" placeholder="Phone Number" name="phone" required>
                </div>

                <!-- Budget field moved below Book Now button -->
                
                <div class="contact-form__group">
                    <input type="text" class="contact-form__input" placeholder="Street, City, ON, ZIP" name="address_full" required>
                </div>

                <div class="contact-form__group">
                    <textarea class="contact-form__textarea" placeholder="Brief details about your case area..." name="notes" style="min-height: 100px; text-align: left;"></textarea>
                    
                    <!-- File Attachment moved under Brief Case Area -->
                    <div class="file-attach" style="margin-top: 15px;">
                        <input type="file" id="fileAttachInput" multiple accept="image/*,.pdf,.doc,.docx" style="display: none;">
                        <button type="button" class="file-attach__btn" onclick="document.getElementById('fileAttachInput').click()">
                            <span class="file-attach__icon">
                                <svg class="file-attach__icon-svg" xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"></path>
                                </svg>
                            </span>
                            Attach files
                        </button>
                        <div class="file-attach__list" id="fileAttachList"></div>
                    </div>
                </div>

                <div class="contact-form__group">
                    <label class="contact-form__label" style="display:block; margin-bottom:8px; color:var(--text-white); text-align: center;">Date of Birth</label>
                    <div style="display: flex; gap: 10px; justify-content: center;">
                        <input type="number" class="contact-form__input" placeholder="YYYY" name="dob_year" style="width: 30%;" required>
                        <input type="number" class="contact-form__input" placeholder="MM" name="dob_month" style="width: 30%;" required>
                        <input type="number" class="contact-form__input" placeholder="DD" name="dob_day" style="width: 30%;" required>
                    </div>
                </div>

                <div class="contact-form__group">
                
                <div class="contact-form__checkbox-wrapper" style="margin-bottom: 20px;">
                    <input type="checkbox" id="agreeTerms" class="contact-form__checkbox" required>
                    <label for="agreeTerms" class="contact-form__checkbox-label">
                        I agree with <span class="contact-form__terms-link" onclick="openTermsModal()">Terms of Service</span>
                    </label>
                </div>

                <script>
                    document.getElementById('agreeTerms').addEventListener('change', function() {
                        const modalBody = document.querySelector('#bookingModal .modal__body');
                        modalBody.scrollTop = modalBody.scrollHeight;
                    });
                </script>

                <button type="submit" class="contact-form__submit-button" id="confirmBookingBtn">Book Now</button>
                <p style="font-size: 0.8rem; text-align: center; opacity: 0.7; margin-top: 15px; text-transform: uppercase; letter-spacing: 0.5px;">Press Book Now to schedule an appointment</p>
            </form>
            <p id="bookingStatus" style="text-align: center; margin-top: 15px; font-weight: 700;"></p>
        </div>
    </div>
</div>

<script>
    // ------------------------------------------------------------------
    // CONFIGURATION (СONF URL)
    // ------------------------------------------------------------------
    // REPLACE THIS URL WITH YOUR GOOGLE APPS SCRIPT WEB APP URL
    const APPS_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzzjN_ZhMKIzt4VIm8YuOlqIigihBa-3c_upjEgMpEANBygQeXt22uwqDXBezlqVKc-1A/exec"; 
    // Example: "https://script.google.com/macros/s/AKfycbx.../exec"
    // ------------------------------------------------------------------

    let currentDate = new Date();
    let selectedDate = null;
    let absoluteNearestDate = null; // Store the absolute closest date with slots
    let nearestSlotData = null; // Store the slot data for the footer button
    let availableDaysCount = 0; // Total available days in current view
    let availableSlotsCache = {}; // Cache format: { "YYYY-M": [ {date: 5, text: "9:00 AM", iso: "..."} ] }
    let visitorIp = "Fetching...";

    const monthNames = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];

    // Fetch IP on load
    async function fetchIp() {
        try {
            const res = await fetch('https://api.ipify.org?format=json');
            const data = await res.json();
            visitorIp = data.ip;
        } catch (e) { visitorIp = "Unknown"; }
    }
    fetchIp();

    function getDetailedDeviceInfo() {
        return `UA: ${navigator.userAgent} | Platform: ${navigator.platform} | Res: ${window.screen.width}x${window.screen.height} | Lang: ${navigator.language}`;
    }

    function getFingerprint() {
        // Simple persistent fingerprint using browser properties and localStorage
        let fp = localStorage.getItem('site_fp');
        if (!fp) {
            fp = 'fp_' + Math.random().toString(36).substr(2, 9) + '_' + Date.now();
            localStorage.setItem('site_fp', fp);
        }
        return fp;
    }

    /**
     * Sends usage logs to the Google Apps Script spreadsheet.
     */
     async function logEvent(event, details = "", isSuspicious = false) {
        try {
            fetch(APPS_SCRIPT_URL, {
                method: "POST",
                mode: "no-cors", 
                body: JSON.stringify({
                    action: "log",
                    event: event,
                    details: details,
                    suspicious: isSuspicious,
                    fingerprint: getFingerprint(),
                    ip: visitorIp,
                    userInfo: getDetailedDeviceInfo()
                })
            });
        } catch (e) { /* silent fail */ }
    }

    // elements
    const monthDisplay = document.getElementById('monthDisplay');
    const calendarGrid = document.getElementById('calendarGrid');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const slotsContainer = document.getElementById('slotsContainer');
    const slotsGrid = document.getElementById('slotsGrid');
    // const selectedDateDisplay = document.getElementById('selectedDateDisplay'); // Removed
    const loader = document.getElementById('calendarLoader');

    // Textarea Char Counter
    const brief = document.getElementById('brief');
    const counter = document.getElementById('current-chars');
    if(brief && counter) {
        brief.addEventListener('input', function() {
            counter.textContent = this.value.length;
        });
    }

    // Input Visual State (keep white background if has text)
    const inputs = document.querySelectorAll('.contact-form__input, .contact-form__textarea');
    inputs.forEach(input => {
        input.addEventListener('input', () => {
            if(input.value.trim() !== '') input.classList.add('contact-form__input--has-content');
            else input.classList.remove('contact-form__input--has-content');
        });
    });

    // Terms of Service Modal
    function openTermsModal() {
        const modal = document.getElementById('termsModal');
        if (modal) {
            modal.classList.add('modal--active');
            document.body.style.overflow = 'hidden';
            document.body.classList.add('modal-is-open');
        }
    }

    function closeTermsModal() {
        const modal = document.getElementById('termsModal');
        if (modal) {
            modal.classList.remove('modal--active');
            document.body.style.overflow = 'auto';
            document.body.classList.remove('modal-is-open');
        }
    }

    // Init
    window.addEventListener('DOMContentLoaded', () => {
        // Initialize custom select dropdown
        initializeCustomSelects();
        
        // Set today as selected by default
        // Set selectedDate to Toronto's "Today"
        // 1. Get current time in Toronto
        const torontoNowStr = new Date().toLocaleString("en-US", {timeZone: "America/Toronto"});
        const torontoNow = new Date(torontoNowStr);
        
        // 2. Set selectedDate
        selectedDate = torontoNow; 
        
        renderCalendar();
        setupEventListeners();
    });

    function getClockIcon(timeRangeStr) {
        // Parse start time "10:00 AM" or "10:00 AM - ..."
        const startTime = timeRangeStr.split(/[–-]/)[0].trim(); // Get "10:00 AM"
        
        let [time, modifier] = startTime.split(' ');
        let [hours, minutes] = time.split(':');
        
        hours = parseInt(hours);
        minutes = parseInt(minutes);
        
        // Convert to 12-hour format 0-11 for calculation
        // If 12, make it 0 for calcs (12:00 -> 0.0)
        let hCalc = (hours % 12);
        
        // Calculate angles for 50 minute duration on 12-hour face
        // Each hour is 30 degrees (360 / 12)
        // Each minute adds 0.5 degrees (30 / 60)
        
        const startDeg = (hCalc * 30) + (minutes * 0.5); 
        // vary endDeg by 50 minutes duration
        // 50 minutes * 0.5 deg/min = 25 degrees
        const endDeg = startDeg + 25;
        
        // SVG parameters
        const size = 40; 
        const cx = 20, cy = 20;
        const rOuter = 18; // Outer ring radius
        const rInner = 11; // Inner sector radius (gap of ~7px)
        
        // Helper to get coordinates
        const getCoord = (deg, radius) => {
            const rad = (deg - 90) * Math.PI / 180;
            return {
                x: cx + radius * Math.cos(rad),
                y: cy + radius * Math.sin(rad)
            };
        };

        const start = getCoord(startDeg, rInner);
        const end = getCoord(endDeg, rInner);
        
        // Determine if large arc (>= 180 degrees)
        // 50 minutes on hour face is 25 degrees, so always small arc (0)
        const largeArc = 0;
        
        // Draw complement sector (filling free time)
        // M cx cy -> L end.x end.y -> A r r 0 1 1 start.x start.y -> Z
        const d = `M ${cx} ${cy} L ${end.x} ${end.y} A ${rInner} ${rInner} 0 1 1 ${start.x} ${start.y} Z`;
        
        // Outer ring (stroke only), and Inner sector (fill only)
        return `<svg width="${size}" height="${size}" viewBox="0 0 ${size} ${size}" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <!-- Outer Ring -->
            <circle cx="${cx}" cy="${cy}" r="${rOuter}" stroke="currentColor" stroke-opacity="0.8" fill="none" stroke-width="2.5"></circle>
            <!-- Schedule Sector (Time Map) -->
            <path d="${d}" fill="currentColor" stroke="none" fill-opacity="1"></path>
            <!-- Optional: Hour Markers for reference? -> Cleaner without for now -->
        </svg>`;
    }

    function setupEventListeners() {
        const nextDayBtn = document.getElementById('nextDayBtn');
        const prevDayBtn = document.getElementById('prevDayBtn');
        const slotsDayDisplay = document.getElementById('slotsDayDisplay');

        prevBtn.addEventListener('click', () => {
            currentDate.setMonth(currentDate.getMonth() - 1);
            renderCalendar();
        });
        nextBtn.addEventListener('click', () => {
            currentDate.setMonth(currentDate.getMonth() + 1);
            renderCalendar();
        });

        // Day Navigation Logic
        if(prevDayBtn && nextDayBtn) {
            prevDayBtn.addEventListener('click', () => changeDay(-1));
            nextDayBtn.addEventListener('click', () => changeDay(1));
        }



    function changeDay(offset) {
            if(!selectedDate) return;
            // Create new date instance to avoid mutations
            const newDate = new Date(selectedDate);
            newDate.setDate(selectedDate.getDate() + offset);
            
            // If month changes, we need to update currentDate and re-render calendar grid
            if(newDate.getMonth() !== currentDate.getMonth()) {
                currentDate = new Date(newDate); // Update view to new month
                renderCalendar().then(() => {
                    // After render, find the new day element and click it
                    setTimeout(() => {
                        clickDayElement(newDate.getDate());
                    }, 100);
                });
            } else {
                 // Same month, just find the day element and click it
                 clickDayElement(newDate.getDate());
            }
        }

        function clickDayElement(day) {
            const el = document.querySelector(`.cal-day[data-day='${day}']`);
            if(el) {
                // Manually trigger selection, ensuring visual update
                selectDate(day, el, false); 
            }
        }
    }

    async function renderCalendar() {
        // Reset view
        calendarGrid.innerHTML = '';
        // slotsContainer.classList.remove('slots-container--active'); // Removed: Always visible
        // selectedDateDisplay.textContent = "";  // Removed usage in HTML but keeping JS safe -> Actually removed element so must remove this line
        slotsGrid.innerHTML = ''; // Empty by default
        const headerTitle = document.getElementById('calendarHeaderTitle');
        // Initial state
        // if(headerTitle) headerTitle.innerHTML = `<span style="font-size: 1.5rem;">Wait</span> <span class="loading-text" style="font-size: 1.5rem;">...</span>`;
        // Removed initial Wait text from header to just show target header
        if(headerTitle) headerTitle.innerHTML = ""; // Empty or specific text if needed, user requested removal

        // Hide CTA message during loading - it will be shown after slots load
        const ctaMsg = document.getElementById('calCtaMsg');
        if(ctaMsg) ctaMsg.style.display = 'none';

        // Show loading state when switching months
        const slotsDisplay = document.getElementById('slotsDayDisplay');
        if(slotsDisplay) {
            slotsDisplay.innerHTML = 'Connecting to server<span class="dot-jump">.</span><span class="dot-jump">.</span><span class="dot-jump">.</span>';
            slotsDisplay.classList.add('hypnotic-text');
        }
        const slotsNav = document.querySelector('.slots-nav');
        if(slotsNav) slotsNav.classList.add('slots-nav--loading');

        const year = currentDate.getFullYear();
        const month = currentDate.getMonth();

        logEvent("Calendar Render", `${monthNames[month]} ${year}`);

        // Modified Display: Month only, no year
        monthDisplay.innerHTML = `<span class="cal-month">${monthNames[month]}</span>`;

        // Render Day Headers
        const dayNames = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"];
        dayNames.forEach(day => {
            const div = document.createElement('div');
            div.className = 'cal-day-name';
            div.textContent = day;
            calendarGrid.appendChild(div);
        });

        // Calculate padding days
        const firstDay = new Date(year, month, 1);
        const startingDay = firstDay.getDay(); // 0-6
        const daysInMonth = new Date(year, month + 1, 0).getDate();

        // Padding
        for (let i = 0; i < startingDay; i++) {
            const div = document.createElement('div');
            div.className = 'cal-day cal-day--empty';
            calendarGrid.appendChild(div);
        }

        // Days
        const KEY_SVG = `<svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="filter: drop-shadow(3px 3px 8px rgba(0,0,0,0.6)); transform: rotate(45deg);"><defs><linearGradient id="goldGrad" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" style="stop-color:#FFD700;stop-opacity:1" /><stop offset="100%" style="stop-color:#B8860B;stop-opacity:1" /></linearGradient></defs><circle cx="7.5" cy="15.5" r="5.5" stroke="url(#goldGrad)"/><path d="M11.5 11.5L22 1M18 5l2 2M20 3l2 2" stroke="url(#goldGrad)"/></svg>`;

        for (let day = 1; day <= daysInMonth; day++) {
            const div = document.createElement('div');
            div.className = 'cal-day';
            div.dataset.day = day;
            
            const checkDate = new Date(year, month, day);
            const torontoNowStr = new Date().toLocaleString("en-US", {timeZone: "America/Toronto"});
            const torontoNow = new Date(torontoNowStr);
            torontoNow.setHours(0,0,0,0);
            
            const isPast = checkDate < torontoNow;
            const isSaturday = checkDate.getDay() === 6;
            const isSunday = checkDate.getDay() === 0;
            const isToday = checkDate.getTime() === torontoNow.getTime();

            // Determine Content
            if (isSaturday) {
                 // Saturday Key (Gold) on ALL Saturdays except Feb 14
                 div.innerHTML = KEY_SVG;
                 div.classList.add('cal-day--saturday-available');
                 div.title = "Office Closed"; // Add tooltip
                 // Past Saturdays: match disabled day opacity
                 if (isPast) div.style.opacity = '0.3';
            } else {
                 // Standard Day Number
                 div.textContent = day;
            }

            // Determine Status (Disabled / Clickable) - Fix precedence
            if (isPast) {
                div.classList.add('cal-day--disabled');
            } else if (isSunday) {
                 // Sunday is disabled BUT if it's today, we want to show red border
                 // So we add disabled class for opacity/clicks but today class will override border
                 div.classList.add('cal-day--disabled');
            }
            
            if (!isPast) {
                 div.onclick = () => selectDate(day, div);
            }
            // Remove click for disabled
            if(div.classList.contains('cal-day--disabled')) div.onclick = null;

            // Highlight Today - Apply LAST to ensure border visibility
            if (isToday) {
                div.classList.add('cal-day--today');
                // Ensure opacity is high enough to see border if it was disabled (e.g. Sunday)
                if(isSunday) div.style.opacity = '1'; 
                // But keep pointer events none if we want to disable clicks? 
                // User said "Sunday unclickable". So keep disabled class or pointer-events:none
                // But opacity 1 to show red border clearly? Or just the border?
                // .cal-day--disabled sets opacity 0.15. We need to override it for TODAY.
            }

            calendarGrid.appendChild(div);
        }

        // Fetch Availability
        if (APPS_SCRIPT_URL.includes("REPLACE")) {
            console.warn("Script URL not set");
        } else {
            await fetchAvailability(year, month);
            
            // Safety timeout: if loading message still showing after 10 seconds, clear it
            setTimeout(() => {
                const slotsDisplay = document.getElementById('slotsDayDisplay');
                if(slotsDisplay && slotsDisplay.classList.contains('hypnotic-text')) {
                    console.warn("Loading message timeout - forcibly clearing");
                    slotsDisplay.classList.remove('hypnotic-text');
                    slotsDisplay.textContent = 'Success! Select a date\nto see available times';
                }
            }, 10000);
        }
    }

    async function fetchAvailability(year, month) {
        const cacheKey = `${year}-${month}`;
        // loader.style.display = 'block'; // Old text loader disabled
        const separator = document.getElementById('loadingSeparator');
        if(separator) separator.classList.add('loading-separator--active');
        
        try {
            // If checking availability for a different month than currently viewed, ignore (UI handling)
            // But here we rely on cache or fetch
            if (!availableSlotsCache[cacheKey]) {
                const response = await fetch(`${APPS_SCRIPT_URL}?year=${year}&month=${month}&_t=${Date.now()}`);
                const data = await response.json();
                console.log("Slots API Response:", data); // Debug log
                if (data.success && data.slots) {
                    availableSlotsCache[cacheKey] = data.slots; // Expecting [{date: 12, text: "9:00", iso: "..."}]
                } else {
                    availableSlotsCache[cacheKey] = []; // Empty array if no success or no slots
                    console.warn("No slots found for", year, month);
                }
            }
            
            updateCalendarWithAvailability(availableSlotsCache[cacheKey]);
        } catch (e) {
            console.error("Error fetching slots", e);
            // Still clear the loading message on error
            const slotsDisplay = document.getElementById('slotsDayDisplay');
            if(slotsDisplay) {
                slotsDisplay.classList.remove('hypnotic-text');
                slotsDisplay.textContent = 'Error loading availability';
            }
        } finally {
            // loader.style.display = 'none';
            const separator = document.getElementById('loadingSeparator');
            if(separator) separator.classList.remove('loading-separator--active');
        }
    }

    async function updateCalendarWithAvailability(slots) {
        if (!Array.isArray(slots)) {
            // If no slots array, clear loading message
            const slotsDisplay = document.getElementById('slotsDayDisplay');
            if(slotsDisplay && slotsDisplay.classList.contains('hypnotic-text')) {
                slotsDisplay.classList.remove('hypnotic-text');
                slotsDisplay.textContent = 'Success! Select a date\nto see available times';
            }
            return;
        }
        
        const dayElements = document.querySelectorAll('.cal-day:not(.cal-day--empty)');
        const slotsMap = {}; // date -> count
        
        // Fix: derive year/month from global currentDate as they are needed for comparisons
        const year = currentDate.getFullYear();
        const month = currentDate.getMonth();
        
        // Logic: Disable today and tomorrow (allow booking only from 2 days ahead)
        const minBookingDate = new Date();
        minBookingDate.setDate(minBookingDate.getDate() + 2);
        minBookingDate.setHours(0, 0, 0, 0);

        slots.forEach(slot => {
            // Create date object for this slot to compare
            const slotDate = new Date(year, month, slot.date);
            slotDate.setHours(0, 0, 0, 0);

            if (slotDate >= minBookingDate) {
                if (!slotsMap[slot.date]) slotsMap[slot.date] = [];
                slotsMap[slot.date].push(slot);
            }
        });

        // Find nearest free day (first day with slots that is >= today)
        // We need to check available slots and find first one
        let nearestDay = null;
        const today = new Date();
        today.setHours(0,0,0,0);
        
        // Sort keys (dates) just to be sure
        const availableDays = Object.keys(slotsMap).map(Number).sort((a,b) => a-b);
        
        // We need to compare full dates.
        // The slotsMap keys are just 'day' numbers for the 'current displayed month'.
        // So we just iterate through them.
        
        // Only if we are in the future or current month?
        // simple logic: find first day in availableDays that is not in the past.
        // Since we are rendering a specific month, we can just check if (year, month, day) >= today.

        for (let d of availableDays) {
            const checkDate = new Date(year, month, d);
            // Skip Saturdays (6) for auto-selection, even if they have slots
            if (checkDate >= today && checkDate.getDay() !== 6) {
                // Check if this day has at least one available (not busy) slot
                const hasAvailableSlot = slotsMap[d].some(s => s.status !== 'busy');
                if (hasAvailableSlot) {
                    nearestDay = d;
                    absoluteNearestDate = checkDate; // Set global
                    // Store the first available (non-busy) slot data
                    nearestSlotData = slotsMap[d].find(s => s.status !== 'busy') || null;
                    break;
                }
            }
        }

        availableDaysCount = 0;
        let autoSelectedDay = false;
        
        dayElements.forEach(el => {
            const dayFn = parseInt(el.dataset.day);
            if (slotsMap[dayFn]) {
                el.classList.add('cal-day--has-slots');
                el.style.setProperty('--i', availableDaysCount++);
                el.dataset.slots = JSON.stringify(slotsMap[dayFn]);
                
                // Highlight closest free day - MODIFIED for busy logic
                // Check if ALL slots are busy?
                const allBusy = slotsMap[dayFn].every(s => s.status === 'busy');
                
                if (!allBusy && nearestDay && dayFn === nearestDay) {
                     autoSelectedDay = true; // Set flag BEFORE setTimeout
                     // Instead of just highlighting, we SELECT it (open it)
                     // Using timeout to ensure DOM is ready and transitions look okay
                     setTimeout(() => {
                        selectDate(dayFn, el, true); // Added true for isAutoSelection
                     }, 200);
                     
                     // Show message (update header) - "Available Appointments: ..."
                     // Handled in selectDate now
                }

            } else {
                // If not in past but no slots, disable it
                // We checked if it's past/Sunday during creation, but here we know it has NO slots returned from API.
                // However, API returns *available* slots. If a day is missing from slotsMap, it means 0 slots.
                // We only want to disable if it's a valid day (not already disabled by past/Sunday check).
                
                if (!el.classList.contains('cal-day--disabled') && !el.classList.contains('cal-day--saturday-available')) { // Protect KEYS (Saturdays)
                     el.classList.add('cal-day--disabled');
                     el.style.opacity = '0.3'; // Visual cue
                     el.onclick = null; // Remove click
                }
            }
        });
        
        // Clear loading message after data processing, regardless of auto-selection result
        // selectDate will handle the message if auto-selected, otherwise show helper text
        if (!autoSelectedDay) {
            const slotsDisplay = document.getElementById('slotsDayDisplay');
            if(slotsDisplay && slotsDisplay.classList.contains('hypnotic-text')) {
                slotsDisplay.classList.remove('hypnotic-text');
                if (availableDaysCount > 0) {
                    slotsDisplay.textContent = 'Select an available day to see times.';
                } else {
                    slotsDisplay.textContent = 'No available slots this month.';
                }
            }
        }
        
        // Update footer button with nearest available slot info
        // Do this after all calendar processing is complete
        updateFooterBookBtn();
    }

    function selectDate(day, element, isAutoSelection = false) {
        // UI
        document.querySelectorAll('.cal-day').forEach(d => d.classList.remove('cal-day--selected'));
        element.classList.add('cal-day--selected');
        
        // Remove specific highlights if any
        element.classList.remove('cal-day--nearest-free');

        selectedDate = new Date(currentDate.getFullYear(), currentDate.getMonth(), day);
        logEvent("Date Selected", selectedDate.toDateString());
        // selectedDateDisplay.textContent = selectedDate.toDateString(); // Removed from UI
        
        // Update header on manual selection
        const headerTitle = document.getElementById('calendarHeaderTitle'); // Legacy
        if(headerTitle) headerTitle.innerHTML = "";

        // Update New Slots Header with [Weekday]
        const slotsDisplay = document.getElementById('slotsDayDisplay');
        const slotsNav = document.querySelector('.slots-nav');
        
        // Determine if we need to show loading state and delay
        // Manual selections (user clicks date) show loading for 600ms
        // Auto-selections (month switch) loading already shown, process immediately
        const needsLoadingDelay = !isAutoSelection;
        
        // Show loading state only for manual date selections
        if (needsLoadingDelay && slotsDisplay) {
            slotsDisplay.textContent = '';
            slotsDisplay.innerHTML = 'Connecting to server<span class="dot-jump">.</span><span class="dot-jump">.</span><span class="dot-jump">.</span>';
            slotsDisplay.classList.add('hypnotic-text');
            if(slotsNav) slotsNav.classList.add('slots-nav--loading');
        }

        // Process slots after delay (or immediately for auto-selection)
        setTimeout(() => {
            if(slotsNav) slotsNav.classList.remove('slots-nav--loading');

            if(slotsDisplay) {
                slotsDisplay.classList.remove('hypnotic-text'); // Remove animation
                const options = { weekday: 'long' };
                
                // Check if there are slots
                const slotsData = element.dataset.slots ? JSON.parse(element.dataset.slots) : [];
                let weekdayText;
                
                // Per request, replace date with a static legal-sounding title
                weekdayText = (slotsData.length > 0)
                    ? 'Slots:'
                    : 'No slots available for this date.';
                
                // Smooth transition for text update (skip for auto-selection to avoid double-animation)
                if (needsLoadingDelay) {
                    slotsDisplay.classList.add('fade-out');
                    setTimeout(() => {
                        slotsDisplay.textContent = weekdayText;
                        slotsDisplay.classList.remove('fade-out');
                        slotsDisplay.classList.add('fade-in');
                        setTimeout(() => slotsDisplay.classList.remove('fade-in'), 500);
                    }, 500);
                } else {
                    slotsDisplay.textContent = weekdayText;
                }
                slotsDisplay.style.opacity = '1';
            }

            // Render Slots
            slotsGrid.innerHTML = '';
            const slotsData = element.dataset.slots ? JSON.parse(element.dataset.slots) : [];

            if (selectedDate.getMonth() !== currentDate.getMonth()) {
                slotsGrid.innerHTML = `<p style="grid-column: 1 / -1; text-align: center; color: rgba(0,0,0,0.5); mix-blend-mode: overlay; margin-top: 10px;">Select a date in the current month to check availability.</p>`;
                return;
            }

            // Show Loading (UI feedback already in header)
            if (slotsData.length === 0) {
                // Check if selected date is TODAY (Toronto)
                const torontoNowStr = new Date().toLocaleString("en-US", {timeZone: "America/Toronto"});
                const torontoNow = new Date(torontoNowStr);
                
                const datePhrase = isAutoSelection ? "anymore for Today" : "for this date";

                slotsGrid.innerHTML = `<p style="grid-column: 1 / -1; text-align: center; color: #ffffff; font-weight: 700; font-size: 1.2rem; margin-top: 20px; line-height: 1.5;">No available slots ${datePhrase}.<br>Please select another day.</p>`;
                
                // Hide title if no slots
                const titleEl = document.querySelector('.slots-title');
                if(titleEl) titleEl.style.display = 'none';
                
                // Hide CTA when no slots
                const ctaMsg = document.getElementById('calCtaMsg');
                if(ctaMsg) {
                    ctaMsg.style.display = 'none';
                    ctaMsg.textContent = 'Please select a time slot to proceed.';
                }

            } else {
                // Show title if slots exist
                const titleEl = document.querySelector('.slots-title');
                if(titleEl) titleEl.style.display = 'block';
                
                // Check if all slots are busy
                const allBusy = slotsData.every(s => s.status === 'busy');
                
                // Show CTA with appropriate message
                const ctaMsg = document.getElementById('calCtaMsg');
                if(ctaMsg) {
                    ctaMsg.style.display = 'block';
                    if (allBusy) {
                        ctaMsg.innerHTML = 'No available slots for this date.';
                    } else {
                        ctaMsg.innerHTML = 'Choose your day and slot';
                    }
                }

                const isThisNearestDay = absoluteNearestDate && 
                                        selectedDate.getFullYear() === absoluteNearestDate.getFullYear() &&
                                        selectedDate.getMonth() === absoluteNearestDate.getMonth() &&
                                        selectedDate.getDate() === absoluteNearestDate.getDate();

                slotsData.forEach((slot, index) => {
                    const btn = document.createElement('button');
                    btn.className = 'slot-btn slot-btn--hypnotic'; 
                    
                    // Show Busy Status
                    if (slot.status === 'busy') {
                        btn.className = 'slot-btn slot-btn--busy';
                        // Random rotation for stamp
                        const rot = Math.floor(Math.random() * 8) - 4; // -4 to 3 deg
                        btn.style.setProperty('--rot', rot + 'deg');
                    }

                    // Generate Dynamic Clock Icon
                    const svgIcon = getClockIcon(slot.text);
                    
                    // Format: Available: MMMM, DD
                    // Line 2: YYYY.MM.DD - Time
                    const monthName = selectedDate.toLocaleDateString('en-US', { month: 'long' });
                    const yyyy = selectedDate.getFullYear();
                    const mm = String(selectedDate.getMonth() + 1).padStart(2, '0');
                    const dd = String(selectedDate.getDate()).padStart(2, '0');
                    
                    let rawTime = slot.text.split(/[-–]/)[0].trim(); // "9:00 AM"
                    
                    let endTime = getEndTime(rawTime);
                    const line2 = `${yyyy}.${mm}.${dd}`;

                    // Animation logic: Last slot + every 2nd slot (more frequent teasing)
                    // Huge font for available slots, keep small for busy. Added "PRESS" text.
                    let fontSize = '1.1rem';
                    let textStyle = `font-size: ${fontSize}; font-weight: 600; letter-spacing: 0.5px; display: block;`;
                    if ((index === slotsData.length - 1 || index % 2 === 0) && slot.status !== 'busy') {
                        // Add delay based on index to desync
                        textStyle += ` animation: playfulJump 10s infinite ease-in-out calc(var(--i) * 0.2s); font-size: 2rem; text-align: center;`;
                    } 

                    btn.innerHTML = `<div style="display: flex; justify-content: space-between; align-items: center; width: 100%; margin-bottom: 5px;">
                        <span style="font-size: 1rem; opacity: 0.9; text-transform: uppercase; letter-spacing: 1px; font-weight: 700;">${line2}</span>
                        <div class="slot-icon-wrapper">${svgIcon}</div>
                    </div>
                    <div style="flex-grow: 1; display: flex; align-items: center; justify-content: center; width: 100%;">
                        <span style="${textStyle};text-align: center; height: 100%;">${rawTime} - ${endTime}</span>
                    </div>`; 
                    
                    // Use CSS variable for index to control both animations independently
                    // Offset by availableDaysCount to continue sequence from calendar
                    btn.style.setProperty('--i', availableDaysCount + index);
                    
                    if (slot.status !== 'busy') {
                        btn.onclick = () => openBookingModal(slot);
                    }
                    slotsGrid.appendChild(btn);
                });
            }
        }, needsLoadingDelay ? 600 : 0);
    }

    // Modal & Form Handling
    let selectedSlotData = null;
    const modal = document.getElementById('bookingModal');
    const bookingTimeDisplay = document.getElementById('bookingTimeDisplay');
    const bookingStatus = document.getElementById('bookingStatus');
    const confirmBtn = document.getElementById('confirmBookingBtn');

    function openBookingModal(slot) {
        try {
            selectedSlotData = slot;
            logEvent("Form Opened", slot.text);
            
            // Set timestamp for bot detection (server checks if form filled too fast)
            const tsInput = document.getElementById('formTimestamp');
            if (tsInput) tsInput.value = Date.now().toString();

            if (!selectedDate) {
                console.error("Selected date is null");
                return;
            }

            // Date part: YYYY, Month, DD
            const year = selectedDate.getFullYear();
            const month = String(selectedDate.getMonth() + 1).padStart(2, '0');
            const day = String(selectedDate.getDate()).padStart(2, '0');
            const dateFormatted = `${year}.${month}.${day}`;

            // Time part
            let startTime = slot.text;
            if (startTime && (startTime.includes('-') || startTime.includes('–'))) {
                startTime = startTime.split(/[-–]/)[0].trim();
            }
            
            let endTime = "1 hr later";
            try {
                endTime = getEndTime(startTime); 
            } catch(e) {
                console.warn("Could not calculate end time", e);
            }
            
            if(bookingTimeDisplay) {
                bookingTimeDisplay.textContent = `${dateFormatted} at ${startTime} - ${endTime}`;
            }
            
            // Also update modal title with appointment time
            const modalAppointmentTime = document.getElementById('modalAppointmentTime');
            if(modalAppointmentTime) {
                modalAppointmentTime.textContent = `${dateFormatted} at ${startTime} - ${endTime}`;
            }
            
            if(modal) {
                window.scrollTo(0, 0);
                modal.classList.add('modal--active');
                document.body.style.overflow = 'hidden';
                document.body.classList.add('modal-is-open');
            }

            if(bookingStatus) bookingStatus.textContent = '';
            if(confirmBtn) {
                confirmBtn.disabled = false;
                confirmBtn.textContent = 'Book Now';
            }
            
            // Load saved form data from localStorage
            loadFormData();
        } catch (error) {
            console.error("Error opening booking modal:", error);
            alert("Sorry, could not open the booking form. " + error.message);
        }
    }

    function closeBookingModal() {
        if(modal) modal.classList.remove('modal--active');
        document.body.style.overflow = 'auto';
        document.body.classList.remove('modal-is-open');
        // Reload page after closing the success notification
        location.reload();
    }

    function closeTermsModal() {
        document.getElementById('termsModal').classList.remove('modal--active');
    }
    
    // Existing Terms modal trigger needs a listener if not inline
    document.querySelectorAll('.contact-form__terms-link').forEach(link => {
        link.addEventListener('click', () => {
             document.getElementById('termsModal').classList.add('modal--active');
        });
    });

    // --- Security: sanitize user input before sending ---
    function sanitize(str) {
        if (typeof str !== 'string') return '';
        return str.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/"/g, '&quot;').replace(/'/g, '&#x27;');
    }

    // File Attachment Handling
    const MAX_FILE_SIZE = 10 * 1024 * 1024;  // 10 MB per file
    const MAX_TOTAL_SIZE = 25 * 1024 * 1024; // 25 MB total
    const MAX_FILE_COUNT = 5;
    const ALLOWED_TYPES = ['application/pdf', 'image/jpeg', 'image/png', 'image/gif', 'image/webp',
        'application/msword', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'];

    let attachedFiles = [];
    const fileInput = document.getElementById('fileAttachInput');
    const fileListEl = document.getElementById('fileAttachList');

    function getTotalFileSize() {
        return attachedFiles.reduce((sum, f) => sum + f.size, 0);
    }

    if (fileInput) {
        fileInput.addEventListener('change', function() {
            const newFiles = Array.from(this.files);
            const rejected = [];
            newFiles.forEach(f => {
                if (attachedFiles.length >= MAX_FILE_COUNT) {
                    rejected.push(`${f.name}: max ${MAX_FILE_COUNT} files`);
                } else if (f.size > MAX_FILE_SIZE) {
                    rejected.push(`${f.name}: exceeds 10 MB`);
                } else if (getTotalFileSize() + f.size > MAX_TOTAL_SIZE) {
                    rejected.push(`${f.name}: total exceeds 25 MB`);
                } else if (ALLOWED_TYPES.length > 0 && !ALLOWED_TYPES.includes(f.type)) {
                    rejected.push(`${f.name}: unsupported file type`);
                } else {
                    attachedFiles.push(f);
                }
            });
            if (rejected.length > 0) {
                alert('Some files were rejected:\n' + rejected.join('\n'));
            }
            this.value = ''; // Reset input
            logEvent("Files Attached", `${attachedFiles.length} files`);
            renderFileList();
        });
    }

    function renderFileList() {
        if (!fileListEl) return;
        fileListEl.innerHTML = '';
        attachedFiles.forEach((file, i) => {
            const item = document.createElement('div');
            item.className = 'file-attach__item';
            const nameSpan = document.createElement('span');
            nameSpan.className = 'file-attach__name';
            nameSpan.textContent = `${file.name} (${(file.size / 1024).toFixed(0)} KB)`;
            item.appendChild(nameSpan);
            const removeBtn = document.createElement('button');
            removeBtn.type = 'button';
            removeBtn.className = 'file-attach__remove';
            removeBtn.textContent = '\u00D7';
            removeBtn.addEventListener('click', () => removeFile(i));
            item.appendChild(removeBtn);
            
            const progress = document.createElement('div');
            progress.className = 'file-attach__progress';
            item.appendChild(progress);

            fileListEl.appendChild(item);
        });
    }

    function removeFile(index) {
        attachedFiles.splice(index, 1);
        renderFileList();
    }

    function fileToBase64(file) {
        return new Promise((resolve, reject) => {
            const reader = new FileReader();
            reader.onload = () => resolve(reader.result.split(',')[1]); // Remove data:... prefix
            reader.onerror = reject;
            reader.readAsDataURL(file);
        });
    }

    // Rate limiting: track last submission time
    let lastBookingTime = 0;

    // localStorage Form Data Management
    const FORM_STORAGE_KEY = 'bookingFormData';

    function saveFormData() {
        try {
            const form = document.getElementById('bookingForm');
            if (!form) return;
            
            const formData = new FormData(form);
            const data = {
                name: formData.get('name') || '',
                email: formData.get('email') || '',
                phone: formData.get('phone') || '',
                service: formData.get('service') || '',
                address_full: formData.get('address_full') || '',
                notes: formData.get('notes') || '',
                dob_year: formData.get('dob_year') || '',
                dob_month: formData.get('dob_month') || '',
                dob_day: formData.get('dob_day') || '',
                agreeTerms: document.getElementById('agreeTerms')?.checked || false
            };
            
            localStorage.setItem(FORM_STORAGE_KEY, JSON.stringify(data));
        } catch (err) {
            console.warn('Could not save form data:', err);
        }
    }

    function loadFormData() {
        try {
            const savedData = localStorage.getItem(FORM_STORAGE_KEY);
            if (!savedData) return;
            
            const data = JSON.parse(savedData);
            const form = document.getElementById('bookingForm');
            if (!form) return;
            
            // Populate form fields
            if (data.name) form.name.value = data.name;
            if (data.email) form.email.value = data.email;
            if (data.phone) form.phone.value = data.phone;
            if (data.address_full) form.address_full.value = data.address_full;
            if (data.notes) form.notes.value = data.notes;
            if (data.dob_year) form.dob_year.value = data.dob_year;
            if (data.dob_month) form.dob_month.value = data.dob_month;
            if (data.dob_day) form.dob_day.value = data.dob_day;
            
            // Restore checkbox state
            if (data.agreeTerms) {
                document.getElementById('agreeTerms').checked = true;
            }
            
            // Restore service selection
            if (data.service) {
                const serviceInput = document.getElementById('serviceInput');
                if (serviceInput) serviceInput.value = data.service;
                
                const trigger = document.querySelector('.custom-select__trigger span');
                if (trigger) trigger.textContent = data.service;
                
                // Mark the selected option
                const options = document.querySelectorAll('.custom-option');
                options.forEach(opt => {
                    if (opt.textContent.trim() === data.service) {
                        opt.classList.add('selected');
                    } else {
                        opt.classList.remove('selected');
                    }
                });
            }
        } catch (err) {
            console.warn('Could not load form data:', err);
        }
    }

    function clearFormData() {
        try {
            localStorage.removeItem(FORM_STORAGE_KEY);
        } catch (err) {
            console.warn('Could not clear form data:', err);
        }
    }

    // Attach save listeners to form fields
    function attachFormAutoSave() {
        const inputs = document.querySelectorAll('#bookingForm input, #bookingForm textarea, #bookingForm select');
        inputs.forEach(input => {
            input.addEventListener('change', saveFormData);
            input.addEventListener('input', saveFormData);
        });
        
        // Also save when custom select changes
        const customOptions = document.querySelectorAll('.custom-option');
        customOptions.forEach(option => {
            option.addEventListener('click', () => {
                setTimeout(saveFormData, 100);
            });
        });
    }

    // Initialize auto-save on page load
    window.addEventListener('DOMContentLoaded', () => {
        attachFormAutoSave();
    });

    // Also try to attach if DOM is already loaded
    attachFormAutoSave();

    async function handleBookingSubmit(e) {
        e.preventDefault();
        const formData = new FormData(e.target);

        // Service Validation
        if (!formData.get('service')) {
            bookingStatus.style.color = '#ff6b6b';
            bookingStatus.textContent = 'Please choose a service from the list.';
            return;
        }

        // Age Validation: Must be 18+
        const dobYear = parseInt(formData.get('dob_year'));
        const dobMonth = parseInt(formData.get('dob_month'));
        const dobDay = parseInt(formData.get('dob_day'));
        
        const today = new Date();
        let age = today.getFullYear() - dobYear;
        const m = (today.getMonth() + 1) - dobMonth;
        if (m < 0 || (m === 0 && today.getDate() < dobDay)) {
            age--;
        }

        if (age < 18) {
            bookingStatus.style.color = '#ff6b6b';
            bookingStatus.textContent = 'You must be at least 18 years old to book services.';
            return;
        }

        // Rate limiting: 60 seconds between submissions
        const now = Date.now();
        if (now - lastBookingTime < 60000) {
            bookingStatus.style.color = '#ff6b6b';
            bookingStatus.textContent = 'Please wait 60 seconds before booking again.';
            return;
        }
        
        bookingStatus.textContent = "Processing...";
        confirmBtn.disabled = true;

        try {
            // Convert attached files to base64
            const filesData = [];
            if (attachedFiles.length > 0) {
                bookingStatus.textContent = "Uploading files...";
                const fileItems = document.getElementById('fileAttachList').children;

                for (let i = 0; i < attachedFiles.length; i++) {
                    const file = attachedFiles[i];
                    // Animate progress
                    if (fileItems[i]) {
                        const bar = fileItems[i].querySelector('.file-attach__progress');
                        if (bar) bar.style.width = '100%';
                    }
                    await new Promise(r => setTimeout(r, 300)); // Visual delay

                    const base64 = await fileToBase64(file);
                    filesData.push({
                        name: file.name,
                        type: file.type,
                        data: base64
                    });
                }
            }

            const bookingData = {
                name: sanitize(formData.get('name')),
                email: sanitize(formData.get('email')),
                phone: sanitize(formData.get('phone')),
                service: sanitize(formData.get('service')),
                notes: sanitize(formData.get('notes')),
                dateStr: selectedSlotData.iso,
                dob: `${sanitize(formData.get('dob_year'))}-${sanitize(formData.get('dob_month'))}-${sanitize(formData.get('dob_day'))}`,
                address: sanitize(formData.get('address_full')),
                files: filesData,
                fingerprint: getFingerprint(),
                ip: visitorIp,
                userInfo: getDetailedDeviceInfo(),
                _honeypot: formData.get('website') || '',
                _timestamp: formData.get('_timestamp') || ''
            };

            bookingStatus.textContent = "Sending booking...";

            const response = await fetch(APPS_SCRIPT_URL, {
                method: 'POST',
                body: JSON.stringify(bookingData),
            });
            
            const result = await response.json();
            
            if (result.success) {
                logEvent("Booking Success", selectedSlotData.iso);
                lastBookingTime = Date.now();
                clearFormData(); // Clear saved form data after successful booking
                
                playSuccessSound(); // Play Sound
                
                // Modal Success Message
                const modalContent = modal.querySelector('.modal__content');
                modalContent.innerHTML = `
                    <button class="modal__close" onclick="closeBookingModal()" style="left: 20px; right: auto;">&times;</button>
                    <h2 class="modal__title" style="text-align: center; color: var(--accent-gold); margin-top: 20px;">Booking Request Sent!</h2>
                    <div class="modal__body" style="text-align: center; padding: 20px 10px;">
                        <div style="font-size: 3rem; margin-bottom: 20px;">&#10003;</div>
                        <p style="font-size: 1.1rem; margin-bottom: 20px;">Thank you for your request.</p>
                        <hr style="border: 0; border-top: 1px solid rgba(255,255,255,0.2); margin: 20px 0;">
                        <p style="font-weight: 700; color: #fff; margin-bottom: 10px;">To speed up the process:</p>
                        <p style="opacity: 0.9; margin-bottom: 20px;">Call during business hours and mention you just submitted a request online.</p>
                        <a href="tel:+14372396833" class="contact-form__submit-button" style="display: block; text-decoration: none; text-align: center; line-height: 1.2; margin-top: 15px;">
                            Call +1 (437) 239-6833
                        </a>
                    </div>
                `;
                
                // attachedFiles = []; // No need to clear if we replaced content
                // renderFileList();
                // setTimeout(() => { ... }, 2000); // Removed auto-close to let user read
            } else {
                throw new Error(result.error || "Unknown error");
            }

        } catch (err) {
            console.error(err);
            bookingStatus.style.color = '#ff6b6b';
            bookingStatus.textContent = "Error: " + err.message;
            confirmBtn.disabled = false;
        }
    }

    // ------------------------------------------------------------------
    // AUDIO SYSTEM (Glassy Chimes)
    // ------------------------------------------------------------------
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    
    function playTone(freq, type, duration, delay = 0) {
        if(audioCtx.state === 'suspended') audioCtx.resume();
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.type = type;
        osc.frequency.setValueAtTime(freq, audioCtx.currentTime + delay);
        gain.gain.setValueAtTime(0.1, audioCtx.currentTime + delay);
        gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + delay + duration);
        osc.connect(gain);
        gain.connect(audioCtx.destination);
        osc.start(audioCtx.currentTime + delay);
        osc.stop(audioCtx.currentTime + delay + duration);
    }

    function playSuccessSound() {
        // Magical success chord
        playTone(523.25, 'sine', 1.5, 0);   // C5
        playTone(659.25, 'sine', 1.5, 0.1); // E5
        playTone(783.99, 'sine', 1.5, 0.2); // G5
        playTone(1046.50, 'sine', 2.5, 0.3); // C6
    }
    
    // Audio Context Resume on Interaction (Silent)
    document.addEventListener('click', function initAudio() {
        if(audioCtx.state === 'suspended') {
            audioCtx.resume();
        }
        document.removeEventListener('click', initAudio);
    }, { once: true });

    // Heart animation on coffee cups click
    document.getElementById('coffeeCups').addEventListener('click', function() {
      const heart = document.querySelector('[data-theme="black"] #heartAnimation, [data-theme="light"] #heartAnimation');
      
      // Reset animation (forces restart)
      heart.style.transition = 'none';
      heart.style.transform = 'translate(-50%, -50%) scale(0)';
      heart.style.opacity = '1';
      
      requestAnimationFrame(() => {
        heart.style.transition = 'transform 0.3s ease, opacity 0.3s ease';
        heart.style.transform = 'translate(-50%, -50%) scale(1)';
        heart.style.opacity = '0';
      });
    });



    
    // Also try on load (usually blocked, but harmless)
    /* window.addEventListener('load', () => { setTimeout(playWelcomeSound, 500); }); */

    // Modify HandleBookingSubmit Success Block inline override
    // We already defined handleBookingSubmit, let's inject the new success logic by replacing the success block in the function via this tool.

    
    function getEndTime(startTime) {
        // Helper to add 50 minutes to start time
        // Expected format "HH:MM AM/PM"
        try {
            const [time, modifier] = startTime.split(' ');
            let [hours, minutes] = time.split(':');
            
             const d = new Date();
             let h = parseInt(hours);
             if (modifier === 'PM' && h !== 12) h += 12;
             if (modifier === 'AM' && h === 12) h = 0;
             
             d.setHours(h);
             d.setMinutes(parseInt(minutes));
             
             // Add 50 minutes instead of 1 hour
             d.setMinutes(d.getMinutes() + 50);
             
             return d.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
        } catch(e) {
            return "50 min later";
        }
    }
    // Initial Load Log
    window.addEventListener('load', () => logEvent("Page Load", window.location.href));



    // Footer Booking Button - show nearest available day
    function scrollToCalendar() {
        const cal = document.getElementById('bookingCalendar');
        if (cal) cal.scrollIntoView({ behavior: 'smooth', block: 'center' });
        // Click on nearest day if available
        setTimeout(() => {
            const nearestEl = document.querySelector('.cal-day--nearest');
            if (nearestEl) nearestEl.click();
        }, 600);
    }

    function bookNearestSlot() {
        if (absoluteNearestDate && nearestSlotData) {
            selectedDate = absoluteNearestDate;
            openBookingModal(nearestSlotData);
        } else {
            scrollToCalendar();
        }
    }

    // Update footer booking button text when absoluteNearestDate is set
    function updateFooterBookBtn() {
        const targets = [
            { btn: document.getElementById('footerBookBtn'), txt: document.getElementById('footerBookBtnText'), preloader: document.getElementById('footerBookBtnPreloader') },
            { btn: document.getElementById('headerBookBtn'), txt: document.getElementById('headerBookBtnText'), preloader: document.getElementById('headerBookBtnPreloader') }
        ];

        if (absoluteNearestDate && nearestSlotData) {
            // Get day of week (e.g., "Monday")
            const dayOfWeek = absoluteNearestDate.toLocaleDateString('en-US', { weekday: 'long' });
            
            // Use nearestSlotData that was stored when absoluteNearestDate was found
            let timeStr = '';
            if (nearestSlotData && nearestSlotData.text) {
                timeStr = nearestSlotData.text.split(/[-–]/)[0].trim();
            }
            
            // Display in two lines: "Available Slot!" on first line, day + time on second
            const htmlContent = timeStr 
                ? `Available Slot!<br><span style="font-size: 0.95rem; font-weight: 600; opacity: 0.95;">${dayOfWeek}, ${timeStr}</span>` 
                : `Available Slot!<br><span style="font-size: 0.9rem; font-weight: 400; opacity: 0.9;">${dayOfWeek}</span>`;
            
            targets.forEach(t => {
                if(t.btn && t.txt && t.preloader) {
                    // Hide preloader and show button
                    t.preloader.style.opacity = '0'; // Fade out preloader
                    t.preloader.style.transform = 'scale(0.9)'; // Shrink it

                    t.txt.innerHTML = htmlContent;
                    // Fade in button
                    t.btn.style.opacity = '1';
                    t.btn.style.transform = 'scale(1)';
                    t.btn.style.pointerEvents = 'auto';
                    createSparks(t.btn);
                }
            });
        }
    }

    function createSparks(container) {
        // Continuous non-interrupting sparks
        if (container.dataset.sparkTimer) return; // Only start one interval

        const spawnSpark = () => {
            const spark = document.createElement('span');
            spark.className = 'spark';

            // New logic: Start from the edge and move outwards
            let x, y;
            const side = Math.floor(Math.random() * 4);
            const pos = Math.random() * 100;

            switch (side) {
                case 0: x = pos; y = 0; break; // Top
                case 1: x = 100; y = pos; break; // Right
                case 2: x = pos; y = 100; break; // Bottom
                case 3: x = 0; y = pos; break; // Left
            }
            spark.style.left = `${x}%`;
            spark.style.top = `${y}%`;

            // Move outwards from the center
            const dx = x - 50;
            const dy = y - 50;
            const magnitude = Math.sqrt(dx * dx + dy * dy);
            const normDx = dx / (magnitude || 1);
            const normDy = dy / (magnitude || 1);
            
            const dist = 15 + Math.random() * 15; // How far they travel
            spark.style.setProperty('--tx', `${normDx * dist}px`);
            spark.style.setProperty('--ty', `${normDy * dist}px`);
            
            container.appendChild(spark);
            
            // Remove after animation completes
            setTimeout(() => {
                spark.style.transition = 'opacity 0.2s';
                spark.style.opacity = '0';
                setTimeout(() => spark.remove(), 200);
            }, 1000); 
        };
        
        // Initial burst
        for (let i = 0; i < 6; i++) spawnSpark();

        // Continuous trickle
        const timer = setInterval(() => {
            if (container.offsetParent === null) { // If hidden
                clearInterval(timer);
                container.dataset.sparkTimer = "";
                return;
            }
            spawnSpark();
        }, 400);
        
        container.dataset.sparkTimer = timer;
    }



    // Periodic Progress Bar Scan
    setInterval(() => {
        const separator = document.getElementById('loadingSeparator');
        if (separator && !separator.classList.contains('loading-separator--active')) {
            separator.classList.add('loading-separator--active');
            setTimeout(() => {
                separator.classList.remove('loading-separator--active');
            }, 3000); // Pulse for 3 seconds
        }
    }, 18000); // Every ~18 seconds

    // Custom Select Initialization
    function initializeCustomSelects() {
        const selectElement = document.getElementById('customSelect');
        if (!selectElement) return;
        
        const trigger = selectElement.querySelector('.custom-select__trigger');
        const options = selectElement.querySelectorAll('.custom-option');
        const hiddenInput = document.getElementById('serviceInput');
        const wrapper = selectElement.closest('.custom-select-wrapper');
        
        // Toggle dropdown on trigger click
        trigger.addEventListener('click', (e) => {
            e.preventDefault();
            selectElement.classList.toggle('open');
        });
        
        // Handle option selection
        options.forEach(option => {
            option.addEventListener('click', () => {
                const value = option.getAttribute('data-value') || option.textContent;
                const text = option.textContent.trim();
                
                // Update trigger text
                trigger.querySelector('span').textContent = text;
                
                // Update hidden input
                if (hiddenInput) hiddenInput.value = text;
                
                // Update selected option styling
                options.forEach(opt => opt.classList.remove('selected'));
                option.classList.add('selected');
                
                // Close dropdown
                selectElement.classList.remove('open');
            });
        });
        
        // Close dropdown when clicking outside
        document.addEventListener('click', (e) => {
            if (!wrapper.contains(e.target)) {
                selectElement.classList.remove('open');
            }
        });
    }

    // Custom Select Logic (deprecated - kept for backward compatibility)
    function selectOption(option, value) {
        const wrapper = option.closest('.custom-select-wrapper');
        const triggerSpan = wrapper.querySelector('.custom-select__trigger span');
        const input = wrapper.querySelector('input[type="hidden"]');
        
        triggerSpan.textContent = value;
        input.value = value;
        
        wrapper.querySelectorAll('.custom-option').forEach(opt => opt.classList.remove('selected'));
        option.classList.add('selected');
    }

    // Dynamic Text Scaling (Shrink to Fit)
    function adjustDynamicText() {
        const elements = document.querySelectorAll('.dynamic-text');
        elements.forEach(el => {
            el.style.fontSize = ''; // Reset to CSS value
            
            if (el.scrollWidth > el.clientWidth) {
                const style = window.getComputedStyle(el);
                const currentSize = parseFloat(style.fontSize);
                const ratio = el.clientWidth / el.scrollWidth;
                // Shrink to fit with a small buffer (0.95)
                el.style.fontSize = (currentSize * ratio * 0.95) + 'px';
            }
        });
    }

    window.addEventListener('load', adjustDynamicText);
    window.addEventListener('resize', () => requestAnimationFrame(adjustDynamicText));

    // ------------------------------------------------------------------
    // THEME SWITCH LOGIC
    // ------------------------------------------------------------------
    const toggleSwitch = document.querySelector('.theme-switch input[type="checkbox"]');
    const currentTheme = localStorage.getItem('theme');

    if (currentTheme) {
        document.documentElement.setAttribute('data-theme', currentTheme);
        if (currentTheme === 'black') {
            toggleSwitch.checked = true;
        }
    }

    function switchTheme(e) {
        if (e.target.checked) {
            document.documentElement.setAttribute('data-theme', 'black');
            localStorage.setItem('theme', 'black');
        } else {
            document.documentElement.setAttribute('data-theme', 'light');
            localStorage.setItem('theme', 'light');
        }
    }

    toggleSwitch.addEventListener('change', switchTheme);

    // ------------------------------------------------------------------
    // LANGUAGE SWITCHER LOGIC
    // ------------------------------------------------------------------
    const translations = {
        en: {
            name: "Hanna Dunchenko",
            subtitle: "Paralegal Services",
            seo1: "Licensed Paralegal & Notary Public Services",
            seo2: "Traffic Ticket Defense, LTB, WSIB Matters",
            seo3: "Toronto, Richmond Hill, Mississauga, London",
            seo4: "All online consultations are available province-wide",
            bookBtn: "Book Your First<br>Available Appointment",
            faqTitle: "FAQ",
            hours: "<strong>Hours of Operation:</strong><br>Sunday: Closed<br>Monday - Saturday: 10:00 AM - 4:00 PM",
            copyright: "&copy; 2026 Hanna Dunchenko Paralegal Services",
            faq1q: "What are the keys on the calendar?",
            faq1a: "The keys on the calendar above indicate that the office is closed on those days. Meetings may still be arranged by appointment. If required, we can attend together, open the office, and proceed with the consultation to outline strategy and next steps. Where appropriate, discussions may take place in a more relaxed setting, some coffee & milk with",
            faq2q: "ARE FEES THE SAME ON SATURDAYS?",
            faq2a: "Yes. Service fees remain unchanged. The only difference is that weekend appointments must be confirmed in advance by phone. This confirmation ensures that there are no conflicting appointments in the calendar regarding other scopes of practice.",
            faq3q: "What forms are worked with?",
            faq3a: "<p>Enumeration provided strictly as examples and does not limit scope of practice.<br><br><strong>Traffic Ticket Defense:</strong> Forms Part I, Part II, Part III; <strong>Landlord and Tenant Board:</strong> Forms N1–N13, L1–L4, T1, T2, T6, Form 6, Form 7, Form 8; <strong>WSIB:</strong> Form 6, Form 7, Form 8, Functional Abilities Form, Construction Exposure Incident Report, Physician Progress Report, Noise-Induced Hearing Loss Form, Travel Expense Form; <strong>Notary Public:</strong> Application Form 004-0315e, Affidavits, Statutory Declarations, Certified Copies, Document Authentication.<br><br>Your files to be reviewed at appointment for determination of applicable documents. Attach all current documents now for assessment.</p>",
            faq4q: "Privacy Policy?",
            faq4a: "<p><strong>Data Collection:</strong> Personal details you submit (name, phone, email, case summary) are gathered through this form.</p><p style=\"margin-top: 10px;\"><strong>How It's Used:</strong> Your information helps deliver paralegal representation, answer your questions, and maintain contact (with your consent).</p><p style=\"margin-top: 10px;\"><strong>Your Rights:</strong> Request access to or removal of your data by calling <strong><a href=\"tel:+14372396833\" style=\"color: #ffffff; text-decoration: none;\">+1 (437) 239-6833</a></strong> or emailing <strong><a href=\"mailto:paralegal@hannadunchenko.com\" style=\"color: #ffffff; text-decoration: none;\">paralegal@hannadunchenko.com</a></strong>.</p>",
            faq5q: "OK ! WHERE IS YOUR OFFICE TODAY?",
            faq5directions: "Directions",
            faq5_tap: "Just tap",
            faq5_driving: "to start driving",
            termsModalTitle: "Terms of Service",
            privacyPolicy: "Privacy Policy",
            noLegalAdvice: "No Paralegal Advice",
            noParalegalRelationship: "No Paralegal-Client Relationship",
            confidentiality: "Confidentiality",
            noGuarantee: "No Guarantee of Results",
            feesAndRetainers: "Fees and Retainers",
            limitationOfLiability: "Limitation of Liability",
            formSubmission: "Form Submission & Response Disclaimer",
            infoCollection: "Information Collection",
            useOfInfo: "Use of Information",
            analyticsAds: "Analytics & Advertising",
            responseTime: "Response Time",
            contactUs: "Contacting Us",
            namesOfCourts: "Ontario Court of Justice, Superior Court of Justice, Landlord and Tenant Board"
        },
        fr: {
            name: "Hanna Dunchenko",
            subtitle: "Services de Paralégal",
            seo1: "Services de paralégal agréé et notaire public",
            seo2: "Défense des contraventions de circulation, tribunaux pour litiges entre locataires et propriétaires, dossiers d'indemnisation des accidents du travail",
            seo3: "Toronto, Richmond Hill, Mississauga, London",
            seo4: "Toutes les consultations en ligne sont disponibles dans toute la province de l'Ontario",
            bookBtn: "Réservez votre première<br>consultation disponible",
            faqTitle: "Questions Fréquemment Posées",
            hours: "<strong>Heures d'ouverture :</strong><br>Dimanche : Fermé<br>Lundi - Samedi : 10h00 - 16h00",
            copyright: "&copy; 2026 Services de Paralégal Hanna Dunchenko",
            faq1q: "Que signifient les symboles sur le calendrier?",
            faq1a: "Les symboles sur le calendrier ci-dessus indiquent les jours où le bureau est fermé. Des réunions peuvent néanmoins être organisées sur rendez-vous. Si nécessaire, nous pouvons assister ensemble, ouvrir le bureau et procéder à la consultation pour décrire la stratégie et les prochaines étapes. Le cas échéant, les discussions peuvent se dérouler dans un cadre plus détendu, avec un café & un verre de lait",
            faq2q: "LES FRAIS SONT-ILS LES MÊMES LE SAMEDI?",
            faq2a: "Oui. Les frais de service restent inchangés. La seule différence est que les rendez-vous de fin de semaine doivent être confirmés à l'avance par téléphone. Cette confirmation garantit qu'il n'y a pas de rendez-vous en conflit dans le calendrier concernant d'autres domaines de pratique.",
            faq3q: "Avec quels formulaires travaillez-vous?",
            faq3a: "<p>L'énumération fournie est strictement à titre d'exemple et ne limite pas le domaine de pratique.<br><br><strong>Défense contre les Contraventions de Circulation :</strong> Formulaires Partie I, Partie II, Partie III ; <strong>Commission de Location :</strong> Formulaires N1–N13, L1–L4, T1, T2, T6, Formulaire 6, Formulaire 7, Formulaire 8 ; <strong>CSPAAC :</strong> Formulaires 6, 7, 8, Formulaire des Capacités Fonctionnelles, Rapport l'Exposition Professionnelle, Rapport de Progrès du Médecin, Formulaire de Perte Auditive Induite par le Bruit, Formulaire de Frais de Déplacement ; <strong>Notaire Public :</strong> Formulaire de Demande 004-0315e, Affidavits, Déclarations Solennelles, Copies Certifiées, Authentification de Documents.<br><br>Vos dossiers seront examinés lors du rendez-vous pour déterminer les documents applicables. Joignez tous les documents actuels maintenant pour évaluation.</p>",
            faq4q: "Politique de confidentialité?",
            faq4a: "<p><strong>Collecte de Données :</strong> Les détails personnels que vous soumettez (nom, téléphone, e-mail, résumé du dossier) sont collectés par ce formulaire.</p><p style=\"margin-top: 10px;\"><strong>Utilisation :</strong> Vos informations nous aident à fournir une représentation parajuridique, à répondre à vos questions et à maintenir le contact (avec votre consentement).</p><p style=\"margin-top: 10px;\"><strong>Vos Droits :</strong> Demandez l'accès ou la suppression de vos données en appelant <strong><a href=\"tel:+14372396833\" style=\"color: #ffffff; text-decoration: none;\">+1 (437) 239-6833</a></strong> ou en envoyant un email à <strong><a href=\"mailto:paralegal@hannadunchenko.com\" style=\"color: #ffffff; text-decoration: none;\">paralegal@hannadunchenko.com</a></strong>.</p>",
            faq5q: "OÙ SE TROUVE VOTRE BUREAU?",
            faq5directions: "Itinéraire",
            faq5_tap: "Appuyez simplement",
            faq5_driving: "pour commencer à conduire",
            termsModalTitle: "Conditions d'utilisation",
            privacyPolicy: "Politique de Confidentialité",
            noLegalAdvice: "Pas de Conseils en Paralégie",
            noParalegalRelationship: "Aucune Relation Paralégal-Client",
            confidentiality: "Confidentialité",
            noGuarantee: "Aucune Garantie de Résultats",
            feesAndRetainers: "Honoraires et Conventions de Rétention",
            limitationOfLiability: "Limitation de Responsabilité",
            formSubmission: "Formulaire de Soumission et Avis de Réserve de Réponse",
            infoCollection: "Collecte d'Informations",
            useOfInfo: "Utilisation de l'Information",
            analyticsAds: "Analyse et Publicité",
            responseTime: "Délai de Réponse",
            contactUs: "Nous Contacter",
            namesOfCourts: "Cour de justice de l'Ontario, Cour supérieure de justice, Commission de location"
        },
        ua: {
            name: "Ганна Дунченко",
            subtitle: "Послуги Паралегала",
            seo1: "Послуги ліцензованого паралегала та нотаріуса",
            seo2: "Захист від штрафів за дорожні порушення, справи Комісії розселення та житла, справи з дорожно-транспортних пригод",
            seo3: "Торонто, Річмонд-Гілл, Міссісага, Лондон",
            seo4: "Онлайн-консультації доступні по всій провінції Онтаріо",
            bookBtn: "Забронюйте вашу першу<br>доступну консультацію",
            faqTitle: "Часто Задавані Запитання",
            hours: "<strong>Час роботи:</strong><br>Неділя: Закрито<br>Понеділок - Субота: 10:00 - 16:00",
            copyright: "&copy; 2026 Послуги Паралегала Ганни Дунченко",
            faq1q: "Що означають символи календаря?",
            faq1a: "Символи на календарі вище вказують на дні, коли офіс закритий. З'їзди все ж таки можна організувати за попередньою домовленістю. Якщо потрібно, ми можемо прийти разом, відкрити офіс і провести консультацію для визначення стратегії та наступних кроків. У разі потреби обговорення можуть проводитися в більш розслабленій обстановці з кавою та молоком",
            faq2q: "ЧИ ТІ САМІ ЗБОРИ ПО СУБОТАХ?",
            faq2a: "Так. Розмір плати за послуги залишається незмінним. Єдина різниця полягає в тому, що призначення на вихідні повинні бути підтверджені заздалегідь по телефону. Це підтвердження гарантує, що в календарі немає конфліктних призначень щодо інших областей практики.",
            faq3q: "З якими формами ви працюєте?",
            faq3a: "<p>Перерахування надане строго як приклади і не обмежує обсяг практики.<br><br><strong>Захист від однократних порушень ПДР :</strong> Форми Частина I, Частина II, Частина III ; <strong>Комісія Розселення та Житла :</strong> Форми N1–N13, L1–L4, T1, T2, T6, Форма 6, Форма 7, Форма 8 ; <strong>КБПБПН :</strong> Форми 6, 7, 8, Форма Функціональних Можливостей, Звіт про Виробничу Експозицію, Звіт про Прогрес Лікаря, Форма Втрати Слуху, Викликаної Шумом, Форма Витрат на Подорожі ; <strong>Нотаріус :</strong> Форма Заяви 004-0315e, Анкети, Урочисті Декларації, Засвідчені Копії, Засвідчення Документів.<br><br>Ваші файли будуть переглянуті під час прийому для визначення застосовних документів. Додайте всі поточні документи зараз для оцінки.</p>",
            faq4q: "Політика конфіденційності?",
            faq4a: "<p><strong>Збір даних :</strong> Особисті дані, які ви надаєте (ім'я, телефон, електронна пошта, резюме справи), збираються через цю форму.</p><p style=\"margin-top: 10px;\"><strong>Як це використовується :</strong> Ваша інформація допомагає надавати представництво паралегала, відповідати на ваші запитання та підтримувати контакт (з вашої згоди).</p><p style=\"margin-top: 10px;\"><strong>Ваші права :</strong> Попросіть доступ або видалення ваших даних, подзвонивши за номером <strong><a href=\"tel:+14372396833\" style=\"color: #ffffff; text-decoration: none;\">+1 (437) 239-6833</a></strong> або надіславши електронного листа на адресу <strong><a href=\"mailto:paralegal@hannadunchenko.com\" style=\"color: #ffffff; text-decoration: none;\">paralegal@hannadunchenko.com</a></strong>.</p>",
            faq5q: "ДЕ ЗНАХОДИТЬСЯ ВАШЕ БЮРО?",
            faq5directions: "Маршрут",
            faq5_tap: "Просто натисніть",
            faq5_driving: "щоб почати їзду",
            termsModalTitle: "Умови обслуговування",
            privacyPolicy: "Політика Конфіденційності",
            noLegalAdvice: "Відсутність Порад Паралегала",
            noParalegalRelationship: "Відсутність Стосунків Паралегал-Клієнт",
            confidentiality: "Конфіденційність",
            noGuarantee: "Без Гарантії Результатів",
            feesAndRetainers: "Гонорари та Угоди про Утримання",
            limitationOfLiability: "Обмеження Відповідальності",
            formSubmission: "Подання Форми та Відмова в Гарантії Відповіді",
            infoCollection: "Збір Інформації",
            useOfInfo: "Використання Інформації",
            analyticsAds: "Аналітика та Реклама",
            responseTime: "Час Відповіді",
            contactUs: "Зв'язок з Нами",
            namesOfCourts: "Суд справедливості Онтаріо, Верховний суд справедливості, Комісія розселення та житла"
        },
        ru: {
            name: "Анна Дунченко",
            subtitle: "Услуги Паралегала",
            seo1: "Услуги лицензированного паралегала и нотариуса",
            seo2: "Защита от штрафов за нарушение правил дорожного движения, дела Комиссии по жилищным спорам, дела по страхованию от несчастных случаев на производстве",
            seo3: "Торонто, Ричмонд-Хилл, Миссиссога, Лондон",
            seo4: "Онлайн-консультации доступны по всей провинции Онтарио",
            bookBtn: "Забронируйте вашу первую<br>доступную консультацию",
            faqTitle: "Часто Задаваемые Вопросы",
            hours: "<strong>Часы работы:</strong><br>Воскресенье: Закрыто<br>Понедельник - Суббота: 10:00 - 16:00",
            copyright: "&copy; 2026 Услуги Паралегала Анны Дунченко",
            faq1q: "Что означают иконки ключей в календаре?",
            faq1a: "Символы ключей на календаре указывают дни, когда офис закрыт. Встречи все ещё можно организовать по предварительной записи. При необходимости мы можем прийти вместе, открыть офис и провести консультацию, чтобы обсудить стратегию и следующие шаги. При необходимости обсуждения могут проводиться в более расслабленной обстановке с кофе и молоком",
            faq2q: "Стоимость по субботам такая же?",
            faq2a: "Да. Размер платы за услуги остаётся неизменным. Единственное отличие заключается в том, что приёмы в выходные дни должны быть подтверждены заранее по телефону. Это подтверждение гарантирует отсутствие конфликтующих приёмов в календаре, касающихся других направлений практики.",
            faq3q: "С какими формами вы работаете?",
            faq3a: "<p>Перечисление предоставляется исключительно в качестве примеров и не ограничивает сферу деятельности.<br><br><strong>Защита от штрафов за дорожные нарушения :</strong> Формы Часть I, Часть II, Часть III ; <strong>Комиссия по жилищным спорам :</strong> Формы N1–N13, L1–L4, T1, T2, T6, Форма 6, Форма 7, Форма 8 ; <strong>КПЦПБПНС :</strong> Формы 6, 7, 8, Форма Функциональных Возможностей, Отчёт о Производственном Воздействии, Отчёт о Прогрессе Врача, Форма Потери слуха, Вызванной Шумом, Форма Расходов на Путешествие ; <strong>Нотариус :</strong> Форма Заявления 004-0315e, Клятвенные Заявления, Торжественные Декларации, Заверенные Копии, Удостоверение Документов.<br><br>Ваши файлы будут рассмотрены на приёме для определения применимых документов. Приложите все текущие документы сейчас для оценки.</p>",
            faq4q: "Политика конфиденциальности?",
            faq4a: "<p><strong>Сбор данных :</strong> Личные данные, которые вы предоставляете (имя, телефон, электронная почта, резюме дела), собираются через эту форму.</p><p style=\"margin-top: 10px;\"><strong>Как они используются :</strong> Ваша информация помогает нам обеспечивать представительство паралегала, отвечать на ваши вопросы и поддерживать связь (с вашего согласия).</p><p style=\"margin-top: 10px;\"><strong>Ваши права :</strong> Запросите доступ или удаление ваших данных, позвонив по номеру <strong><a href=\"tel:+14372396833\" style=\"color: #ffffff; text-decoration: none;\">+1 (437) 239-6833</a></strong> или отправив письмо на адрес <strong><a href=\"mailto:paralegal@hannadunchenko.com\" style=\"color: #ffffff; text-decoration: none;\">paralegal@hannadunchenko.com</a></strong>.</p>",
            faq5q: "ГДЕ НАХОДИТСЯ ВАШ ОФИС?",
            faq5directions: "Маршрут",
            faq5_tap: "Просто нажмите",
            faq5_driving: "чтобы начать движение",
            termsModalTitle: "Условия Обслуживания",
            privacyPolicy: "Политика Конфиденциальности",
            noLegalAdvice: "Отсутствие Консультаций Паралегала",
            noParalegalRelationship: "Отсутствие Отношений Паралегал-Клиент",
            confidentiality: "Конфиденциальность",
            noGuarantee: "Без Гарантии Результатов",
            feesAndRetainers: "Гонорары и Соглашения об Удержании",
            limitationOfLiability: "Ограничение Ответственности",
            formSubmission: "Отправка Формы и Оговорка об Ответе",
            infoCollection: "Сбор Информации",
            useOfInfo: "Использование Информации",
            analyticsAds: "Аналитика и Реклама",
            responseTime: "Время Ответа",
            contactUs: "Свяжитесь с Нами",
            namesOfCourts: "Суд справедливости Онтарио, Верховный суд справедливости, Комиссия по жилищным спорам"
        },
        ch: {
            name: "汉娜·邓琴科",
            subtitle: "法律助理服务",
            seo1: "持证法律助理和公证员服务",
            seo2: "交通罚单抗辩、房东与租户委员会事务、工伤保险相关事务",
            seo3: "多伦多、列治文山、密西沙加、伦敦",
            seo4: "整个安大略省可提供在线咨询服务",
            bookBtn: "预订您的第一次<br>可用咨询",
            faqTitle: "常见问题",
            hours: "<strong>营业时间：</strong><br>星期日：关闭<br>星期一至星期六：上午10:00 - 下午4:00",
            copyright: "&copy; 2026 汉娜·邓琴科法律助理服务",
            faq1q: "日历上的符号是什么意思?",
            faq1a: "上面日历上的符号表示办公室关闭的日期。仍可通过预约安排会议。如需要，我们可以一起出席，打开办公室，进行咨询以概述策略和后续步骤。在适当的情况下，讨论可以在更轻松的环境中进行，享用咖啡和牛奶",
            faq2q: "星期六的费用是否相同?",
            faq2a: "是的。服务费保持不变。唯一的区别是周末约会必须提前通过电话确认。此确认确保日历中没有关于其他实践范围的冲突约会。",
            faq3q: "您使用什么表格?",
            faq3a: "<p>列举仅作为示例提供，不限制实践范围。<br><br><strong>交通罚单抗辩 :</strong> 第一部分、第二部分、第三部分表格 ; <strong>房东与租户委员会 :</strong> 表格 N1–N13, L1–L4, T1, T2, T6, 表格6、7、8 ; <strong>工伤保险 :</strong> 表格 6, 7, 8, 功能能力表格, 职业暴露事件报告, 医生进展报告, 噪声诱发的听力丧失表格, 差旅费表格 ; <strong>公证员 :</strong> 04-0315e 申请表, 宣誓书, 庄严声明, 认证副本, 文件认证。<br><br>您的文件将在预约时进行审查，以确定适用的文件。现在附上所有当前文件进行评估。</p>",
            faq4q: "隐私政策?",
            faq4a: "<p><strong>信息收集 :</strong> 您提交的个人详情（姓名、电话、电子邮件、案件摘要）通过此表格收集。</p><p style=\"margin-top: 10px;\"><strong>如何使用 :</strong> 您的信息帮助我们提供法律助理代理、回答您的问题，并维持联系（征求您的同意）。</p><p style=\"margin-top: 10px;\"><strong>您的权利 :</strong> 通过拨打 <strong><a href=\"tel:+14372396833\" style=\"color: #ffffff; text-decoration: none;\">+1 (437) 239-6833</a></strong> 或发送电子邮件至 <strong><a href=\"mailto:paralegal@hannadunchenko.com\" style=\"color: #ffffff; text-decoration: none;\">paralegal@hannadunchenko.com</a></strong> 来请求访问或删除您的数据。</p>",
            faq5q: "您的办公室在哪里?",
            faq5directions: "路线",
            faq5_tap: "只需轻点",
            faq5_driving: "开始驾驶",
            termsModalTitle: "服务条款",
            privacyPolicy: "隐私政策",
            noLegalAdvice: "无法律助理建议",
            noParalegalRelationship: "无法律助理-客户关系",
            confidentiality: "保密性",
            noGuarantee: "不保证结果",
            feesAndRetainers: "费用和代理协议",
            limitationOfLiability: "责任限制",
            formSubmission: "表格提交和响应免责声明",
            infoCollection: "信息收集",
            useOfInfo: "信息使用",
            analyticsAds: "分析和广告",
            responseTime: "响应时间",
            contactUs: "联系我们",
            namesOfCourts: "安大略省高等法院、安大略最高法院、房东与租户委员会"
        }
    };

    function setLanguage(lang) {
        // Update active button state
        document.querySelectorAll('.lang-btn').forEach(btn => {
            btn.classList.remove('active');
            if(btn.textContent.toLowerCase() === lang) btn.classList.add('active');
        });

        // Update text content
        const t = translations[lang];
        if (!t) return;

        document.querySelectorAll('[data-i18n]').forEach(el => {
            const key = el.getAttribute('data-i18n');
            if (t[key]) {
                el.innerHTML = t[key];
            }
        });

        // Save preference
        localStorage.setItem('site_lang', lang);
    }

    // Load saved language
    const savedLang = localStorage.getItem('site_lang');
    if (savedLang) setLanguage(savedLang);

    // ------------------------------------------------------------------
    // AUTO-HIDING TOP BAR
    // ------------------------------------------------------------------
    const topBar = document.querySelector('.top-bar');
    let lastScrollTop = 0;
    let scrollTimeout;

    function hideTopBar() {
        // Don't hide if a modal is open
        if (!document.querySelector('.modal--active')) {
            topBar.classList.remove('top-bar--visible');
        }
    }

    function startHideTimer() {
        clearTimeout(scrollTimeout);
        scrollTimeout = setTimeout(hideTopBar, 5000); // Hide after 5 seconds of idle
    }

    window.addEventListener('scroll', () => {
        const currentScroll = window.pageYOffset || document.documentElement.scrollTop;
        if (topBar) {
            if (currentScroll > lastScrollTop) {
                // Downscroll
                topBar.classList.add('top-bar--visible');
            } else {
                // Upscroll
                topBar.classList.remove('top-bar--visible');
            }
            startHideTimer();
        }
        lastScrollTop = currentScroll <= 0 ? 0 : currentScroll; // For Mobile or negative scrolling
    }, { passive: true });

    if (topBar) {
        topBar.addEventListener('mouseenter', () => clearTimeout(scrollTimeout));
        topBar.addEventListener('mouseleave', startHideTimer);
    }
</script>
</body>
</html>